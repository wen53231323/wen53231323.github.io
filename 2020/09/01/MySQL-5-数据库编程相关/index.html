<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>MySQL笔记-数据库编程相关 | 远方の博客</title><meta name="author" content="wen"><meta name="copyright" content="wen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="变量系统变量系统变量分类MySQL 中的系统变量以 两个“@” 开头，分为全局系统变量（ global ）以及会话系统变量（ session），如果不写，默认会话级别    系统变量 简介    全局系统变量 @@global仅用于标记全局系统变量，针对于所有会话（连接）有效，但不能跨重启   会话系统变量 @@session仅用于标记会话系统变量，仅针对于当前会话（连接）有效。   常用的系统变"><meta property="og:type" content="article"><meta property="og:title" content="MySQL笔记-数据库编程相关"><meta property="og:url" content="https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/index.html"><meta property="og:site_name" content="远方の博客"><meta property="og:description" content="变量系统变量系统变量分类MySQL 中的系统变量以 两个“@” 开头，分为全局系统变量（ global ）以及会话系统变量（ session），如果不写，默认会话级别    系统变量 简介    全局系统变量 @@global仅用于标记全局系统变量，针对于所有会话（连接）有效，但不能跨重启   会话系统变量 @@session仅用于标记会话系统变量，仅针对于当前会话（连接）有效。   常用的系统变"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/MySQL.png"><meta property="article:published_time" content="2020-08-31T16:00:00.000Z"><meta property="article:modified_time" content="2023-09-02T13:14:31.293Z"><meta property="article:author" content="wen"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/MySQL.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//static.cloudflareinsights.com"><link rel="preconnect" href="//www.clarity.ms"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?[object Object]";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=[object Object]"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","[object Object]")</script><script defer data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;[object Object]&quot;}"></script><script>!function(t,e,c,n,a,r){t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},(a=e.createElement(n)).async=1,a.src="https://www.clarity.ms/tag/[object Object]",(r=e.getElementsByTagName(n)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":5,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"MySQL笔记-数据库编程相关",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-09-02 21:14:31"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/picture/"><i class="fa-fw fas fa-images"></i><span> 图片库</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 视频库</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><span>导航链接</span></a></li><li><a class="site-page child" href="/comment_loading/"><span>评论管理</span></a></li><li><a class="site-page child" href="/custom/"><span>自定义页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/MySQL.png)"><nav id="nav"><span id="blog-info"><a href="/" title="远方の博客"><span class="site-name">远方の博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/picture/"><i class="fa-fw fas fa-images"></i><span> 图片库</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 视频库</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><span>导航链接</span></a></li><li><a class="site-page child" href="/comment_loading/"><span>评论管理</span></a></li><li><a class="site-page child" href="/custom/"><span>自定义页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL笔记-数据库编程相关</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-31T16:00:00.000Z" title="发表于 2020-09-01 00:00:00">2020-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-02T13:14:31.293Z" title="更新于 2023-09-02 21:14:31">2023-09-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="MySQL笔记-数据库编程相关"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><h2 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h2><h3 id="系统变量分类"><a href="#系统变量分类" class="headerlink" title="系统变量分类"></a>系统变量分类</h3><p>MySQL 中的系统变量以 两个“@” 开头，分为全局系统变量（ global ）以及会话系统变量（ session），如果不写，默认会话级别</p><table><thead><tr><th>系统变量</th><th>简介</th></tr></thead><tbody><tr><td>全局系统变量</td><td><code>@@global</code>仅用于标记全局系统变量，针对于所有会话（连接）有效，但不能跨重启</td></tr><tr><td>会话系统变量</td><td><code>@@session</code>仅用于标记会话系统变量，仅针对于当前会话（连接）有效。</td></tr></tbody></table><h3 id="常用的系统变量"><a href="#常用的系统变量" class="headerlink" title="常用的系统变量"></a>常用的系统变量</h3><table><thead><tr><th>变量</th><th>概括</th></tr></thead><tbody><tr><td>@@error</td><td>上一条SQL错误号</td></tr><tr><td>@@identity</td><td>最后一次插入的标识值</td></tr><tr><td>@@rowcount</td><td>受上一个SQL语句影响的行数</td></tr><tr><td>@@serviceName</td><td>该计算机上的SQL服务名称</td></tr><tr><td>@@Version</td><td>SQLServer的版本信息</td></tr></tbody></table><h3 id="全局系统变量（global）"><a href="#全局系统变量（global）" class="headerlink" title="全局系统变量（global）"></a>全局系统变量（global）</h3><p>（1）查看所有或部分全局系统变量</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查看所有全局系统变量</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables;</span><br><span class="line"># 查看满足条件的部分全局系统变量</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%标识符%&#x27;</span>;</span><br><span class="line"># 查看指定全局系统变量</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@global</span>.变量名;</span><br></pre></td></tr></table></figure><p>（2）修改全局系统变量的值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 方式<span class="number">1</span>：修改MySQL 配置文件 ，继而修改MySQL系统变量的值（该方法需要重启MySQL服务）</span><br><span class="line"># 方式<span class="number">2</span>：在MySQL服务运行期间，使用“<span class="keyword">set</span>”命令重新设置全局系统变量的值</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@global</span>.变量名<span class="operator">=</span>变量值;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> 变量名<span class="operator">=</span>变量值;</span><br></pre></td></tr></table></figure><h3 id="会话系统变量（session）"><a href="#会话系统变量（session）" class="headerlink" title="会话系统变量（session）"></a>会话系统变量（session）</h3><p>（1）查看所有或部分会话系统变量</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 查看所有会话系统变量</span><br><span class="line"><span class="keyword">show</span> session variables; </span><br><span class="line"><span class="keyword">show</span> variables;</span><br><span class="line"># 查看满足条件的部分会话变量</span><br><span class="line"><span class="keyword">show</span> session variables <span class="keyword">like</span> <span class="string">&#x27;%标识符%&#x27;</span>;</span><br><span class="line"># 查看指定会话系统变量</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@session</span>.变量名;</span><br><span class="line"><span class="keyword">select</span> @@变量名;</span><br></pre></td></tr></table></figure><p>（2）修改会话系统变量的值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 方式<span class="number">1</span>：修改MySQL 配置文件 ，继而修改MySQL系统变量的值（该方法需要重启MySQL服务）</span><br><span class="line"># 方式<span class="number">2</span>：在MySQL服务运行期间，使用“<span class="keyword">set</span>”命令重新设置会话系统变量的值</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@session</span>.变量名<span class="operator">=</span>变量值;</span><br><span class="line"><span class="keyword">set</span> session 变量名<span class="operator">=</span>变量值;</span><br></pre></td></tr></table></figure><h3 id="MySQL-8-0的新特性—全局变量的持久化"><a href="#MySQL-8-0的新特性—全局变量的持久化" class="headerlink" title="MySQL 8.0的新特性—全局变量的持久化"></a>MySQL 8.0的新特性—全局变量的持久化</h3><p>（1）在MySQL数据库中，全局变量可以通过使用<code>set global</code>语句语句来设置，设置的变量值只会临时生效 。数据库重启后，服务器又会从MySQL配置文件中读取变量的默认值。</p><p>例如，设置服务器语句超时的限制，可以通过设置系统变量max_execution_time来实现：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> MAX_EXECUTION_TIME<span class="operator">=</span><span class="number">2000</span>;  </span><br></pre></td></tr></table></figure><p>（2）MySQL 8.0版本新增了 <code>set persist</code> 命令，设置的变量值会持久化。MySQL会将该命令的配置保存到数据目录下的 mysqld-auto.cnf 文件中，下次启动时会读取该文件，用其中的配置来覆盖默认的配置文件</p><p>例如，设置服务器的最大连接数为1000</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> persist <span class="keyword">global</span> max_connections <span class="operator">=</span> <span class="number">1000</span>;  </span><br></pre></td></tr></table></figure><h2 id="用户变量"><a href="#用户变量" class="headerlink" title="用户变量"></a>用户变量</h2><h3 id="用户变量分类"><a href="#用户变量分类" class="headerlink" title="用户变量分类"></a>用户变量分类</h3><p>MySQL 中的用户变量以 一个“@” 开头，根据作用范围不同，又分为 会话用户变量 和 局部变量 。</p><table><thead><tr><th>用户变量</th><th>简介</th></tr></thead><tbody><tr><td>会话用户变量</td><td>作用域和会话变量一样，只对 当前连接 会话有效</td></tr><tr><td>局部变量</td><td>只在 BEGIN 和 END 语句块中有效，即只能在 存储过程和函数 中使用</td></tr></tbody></table><h3 id="会话用户变量"><a href="#会话用户变量" class="headerlink" title="会话用户变量"></a>会话用户变量</h3><p>（1）会话用户变量的定义</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 方式<span class="number">1</span>：“<span class="operator">=</span>”或“:<span class="operator">=</span>”</span><br><span class="line"><span class="keyword">set</span> @用户变量 <span class="operator">=</span> 值;</span><br><span class="line"><span class="keyword">set</span> @用户变量 :<span class="operator">=</span> 值;</span><br><span class="line"># 方式<span class="number">2</span>：“:<span class="operator">=</span>” 或 <span class="keyword">into</span>关键字 <span class="keyword">select</span> </span><br><span class="line">@用户变量 :<span class="operator">=</span> 表达式 [<span class="keyword">from</span> 等子句]; </span><br><span class="line"><span class="keyword">select</span> 表达式 <span class="keyword">into</span> @用户变量 [<span class="keyword">from</span> 等子句];</span><br></pre></td></tr></table></figure><p>（2）查看用户变量的值 （查看、比较、运算等）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @用户变量</span><br></pre></td></tr></table></figure><p>（3）使用案例：声明两个变量，求和并打印</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@m</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@sum</span><span class="operator">=</span><span class="variable">@m</span><span class="operator">+</span><span class="variable">@n</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@sum</span>;</span><br></pre></td></tr></table></figure><h3 id="局部用户变量（declare）"><a href="#局部用户变量（declare）" class="headerlink" title="局部用户变量（declare）"></a>局部用户变量（declare）</h3><p>（1）使用位置：只能放在 BEGIN … END 中，而且只能放在第一句</p><p>（2）局部用户变量的定义（如果没有default子句，初始值为null）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> 变量名 类型 [<span class="keyword">default</span> 值];</span><br></pre></td></tr></table></figure><p>（3）局部用户变量赋值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 方式<span class="number">1</span>：一般用于赋简单的值</span><br><span class="line"><span class="keyword">set</span> 变量名 <span class="operator">=</span> 值; </span><br><span class="line"><span class="keyword">set</span> 变量名 :<span class="operator">=</span> 值;</span><br><span class="line"># 方式<span class="number">2</span>：一般用于赋表中的字段值</span><br><span class="line"><span class="keyword">select</span> 局部变量名;</span><br></pre></td></tr></table></figure><p>（4）语法结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">	#声明局部变量</span><br><span class="line">	<span class="keyword">declare</span> 变量名<span class="number">1</span> 变量数据类型 [<span class="keyword">default</span> 变量默认值];</span><br><span class="line">	<span class="keyword">declare</span> 变量名<span class="number">2</span>,变量名<span class="number">3</span>,... 变量数据类型 [<span class="keyword">default</span> 变量默认值];</span><br><span class="line">	#为局部变量赋值</span><br><span class="line">	<span class="keyword">set</span> 变量名<span class="number">1</span> <span class="operator">=</span> 值;</span><br><span class="line">	<span class="keyword">select</span> 值 <span class="keyword">into</span> 变量名<span class="number">2</span> [<span class="keyword">FROM</span> 子句];</span><br><span class="line">	#查看局部变量的值</span><br><span class="line">	<span class="keyword">select</span> 变量<span class="number">1</span>,变量<span class="number">2</span>,变量<span class="number">3</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h1 id="游标（cursor）"><a href="#游标（cursor）" class="headerlink" title="游标（cursor）"></a>游标（cursor）</h1><h2 id="游标概括"><a href="#游标概括" class="headerlink" title="游标概括"></a>游标概括</h2><p>（1）游标使用的步骤</p><blockquote><p>①声明游标 —&gt; ②打开游标—&gt;③ 使用游标（从游标中获取数据）—&gt;④ 关闭游标</p></blockquote><p>（2）优缺点和建议</p><ul><li><strong>优点</strong>：游标是 MySQL 的一个重要的功能，为逐条读取 结果集中的数据，提供了完美的解决方案。<br>跟在应用层 面实现相同的功能相比，游标可以在存储程序中使用，效率高，程序也更加简洁。</li><li><strong>缺点</strong>：使用游标的过程中，会对数据行进行加锁，这样在业务并发量大的时候，<br>不仅会影响业务之间的效率，还会消耗系统资源 ，造成内存不足，这是因为游标是在内存中进行的处理。</li><li><strong>建议</strong>：养成用完之后就关闭的习惯，这样才能提高系统的整体效率。</li></ul><h2 id="游标使用"><a href="#游标使用" class="headerlink" title="游标使用"></a>游标使用</h2><p>（1）声明游标（适用于 MySQL、SQL Server、DB2、MariaDB）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> 游标名 <span class="keyword">cursor</span> <span class="keyword">for</span> 查询语句;</span><br><span class="line"># 如果是用 Oracle 或者 PostgreSQL</span><br><span class="line"><span class="keyword">declare</span> 游标名 <span class="keyword">cursor</span> <span class="keyword">is</span> 查询语句;</span><br></pre></td></tr></table></figure><p>（2）打开游标</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> 游标名</span><br></pre></td></tr></table></figure><p>（3）使用游标（从游标中获取数据）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 游标的查询结果集中的字段数，必须跟 <span class="keyword">INTO</span> 后面的变量数一致，否则在存储过程执行的时候，MySQL 会提示错误</span><br><span class="line"><span class="keyword">fetch</span> 游标名 <span class="keyword">into</span> 变量<span class="number">1</span>, 变量<span class="number">2</span> ...</span><br></pre></td></tr></table></figure><p>（4）关闭游标</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 使用完游标后需要关闭掉该游标，因为游标会占用系统资源</span><br><span class="line"><span class="keyword">close</span> 游标名</span><br></pre></td></tr></table></figure><h2 id="游标使用案例"><a href="#游标使用案例" class="headerlink" title="游标使用案例"></a>游标使用案例</h2><p>存储过程功能：累加薪资最高的几个员工的薪资值，直到薪资总和达到limit_total_salary参数的值，返回累加的人数给total_count。</p><p>声明IN参数 limit_total_salary，DOUBLE类型；</p><p>声明OUT参数total_count，INT类型。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># 创建存储过程“get_count_by_limit_total_salary()”</span><br><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span>  get_count_by_limit_total_salary(<span class="keyword">IN</span> limit_total_salary <span class="keyword">DOUBLE</span>,<span class="keyword">OUT</span> total_count <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	#声明局部变量</span><br><span class="line">	<span class="keyword">declare</span> sum_sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>; #记录累加的工资总额</span><br><span class="line">	<span class="keyword">declare</span> emp_sal <span class="keyword">DOUBLE</span>; #记录每一个员工的工资</span><br><span class="line">	<span class="keyword">declare</span> emp_count <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录累加的人数</span><br><span class="line">	#<span class="number">1.</span>声明游标（查询员工工资）</span><br><span class="line">	<span class="keyword">declare</span> emp_cursor <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">SELECT</span> salary <span class="keyword">FROM</span> employees <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line">	#<span class="number">2.</span>打开游标</span><br><span class="line">	<span class="keyword">open</span> emp_cursor;</span><br><span class="line">	# 使用循环结构遍历出每一条数据</span><br><span class="line">	repeat</span><br><span class="line">		#<span class="number">3.</span>使用游标（将每个员工工资赋给变量emp_sal）</span><br><span class="line">		<span class="keyword">fetch</span> emp_cursor <span class="keyword">INTO</span> emp_sal;</span><br><span class="line">		# 记录累加工资</span><br><span class="line">		<span class="keyword">SET</span> sum_sal <span class="operator">=</span> sum_sal <span class="operator">+</span> emp_sal;</span><br><span class="line">		# 记录累加的人数</span><br><span class="line">		<span class="keyword">SET</span> emp_count <span class="operator">=</span> emp_count <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		# 循环结束条件：达到输入的参数limit_total_salary的值</span><br><span class="line">		until sum_sal <span class="operator">&gt;=</span> limit_total_salary</span><br><span class="line">	<span class="keyword">end</span> repeat;</span><br><span class="line">	# 返回值：累加的人数</span><br><span class="line">	<span class="keyword">SET</span> total_count <span class="operator">=</span> emp_count;</span><br><span class="line">	#<span class="number">4.</span>关闭游标</span><br><span class="line">	<span class="keyword">close</span>  emp_cursor;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> get_count_by_limit_total_salary(<span class="number">200000</span>,<span class="variable">@total</span>_count);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@total</span>_count;</span><br></pre></td></tr></table></figure><h1 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h1><h2 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h2><blockquote><p>MySQL提供了许多单行函数，这些函数可用于对查询结果的每一行数据进行处理，并返回一个单独的值。通常用于对特定列或表达式进行计算、转换或提取</p></blockquote><h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3><ul><li>**CONCAT(str1, str2, …)**：将多个字符串连接在一起。</li><li>**LENGTH(str)**：返回字符串的长度。</li><li>**UPPER(str)**：将字符串转换为大写。</li><li>**LOWER(str)**：将字符串转换为小写。</li><li>**SUBSTRING(str, start, length)**：返回字符串的子串。</li></ul><h3 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h3><ul><li>**ABS(x)**：返回一个数的绝对值。</li><li>**ROUND(x, d)**：将一个数四舍五入到指定的小数位数。</li><li>**CEIL(x)**：向上取整，返回不小于x的最小整数。</li><li>**FLOOR(x)**：向下取整，返回不大于x的最大整数。</li><li>**MOD(x, y)**：返回x除以y的余数。</li></ul><h3 id="时间日期函数"><a href="#时间日期函数" class="headerlink" title="时间日期函数"></a>时间日期函数</h3><ul><li>**NOW()**：返回当前日期和时间。</li><li>**CURDATE()**：返回当前日期。</li><li>**CURTIME()**：返回当前时间。</li><li>**DATE_FORMAT(date, format)**：将日期格式化为指定的格式。</li><li>**DATEDIFF(date1, date2)**：计算两个日期之间的天数差。</li></ul><h3 id="条件函数"><a href="#条件函数" class="headerlink" title="条件函数"></a>条件函数</h3><ul><li>**IFNULL(expr1, expr2)**：如果expr1不为空，则返回expr1；否则返回expr2。</li><li>**NULLIF(expr1, expr2)**：如果expr1等于expr2，则返回NULL；否则返回expr1。</li></ul><h2 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h2><blockquote><p>MySQL提供了一组强大的聚合函数，用于对数据进行统计和汇总计算。注意：聚合函数是不能嵌套使用</p></blockquote><p>以下是一些常用的MySQL聚合函数：</p><ul><li>**COUNT()*<em>：计算指定列或表达式的<code>行数</code>。 可以使用COUNT(</em>)来计算所有行数。</li><li>**SUM()**：计算指定列或表达式的<code>总和</code>。</li><li>**AVG()**：计算指定列或表达式的<code>平均值</code>。</li><li>**MAX()**：找出指定列或表达式的<code>最大值</code>。</li><li>**MIN()**：找出指定列或表达式的<code>最小值</code>。</li><li>**GROUP_CONCAT()**：将指定列或表达式的值连接为一个字符串，并使用指定的分隔符进行分隔。</li><li>**STDDEV()**：计算指定列或表达式的标准差。</li><li>**VARIANCE()**：计算指定列或表达式的方差。</li><li>**STDDEV_POP()**：计算指定列或表达式的总体标准差。</li><li>**STDDEV_SAMP()**：计算指定列或表达式的样本标准差。</li><li>**VAR_POP()**：计算指定列或表达式的总体方差。</li><li>**VAR_SAMP()**：计算指定列或表达式的样本方差。</li><li>**BIT_XOR()**：计算指定列或表达式的按位异或运算结果。</li></ul><h1 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h1><h2 id="窗口函数简介"><a href="#窗口函数简介" class="headerlink" title="窗口函数简介"></a>窗口函数简介</h2><p>窗口函数也叫分析函数，可以对结果集中的每一行数据进行分组、排序、聚合等操作，并可以在不影响结果集本身的情况下返回额外的计算值</p><h2 id="聚合函数与窗口函数区别"><a href="#聚合函数与窗口函数区别" class="headerlink" title="聚合函数与窗口函数区别"></a>聚合函数与窗口函数区别</h2><p>聚合函数也可以用于窗口函数，聚合函数是将多条记录聚合为一条；窗口函数是每条记录都会执行，有几条记录执行完还是几条。</p><h2 id="窗口函数分类"><a href="#窗口函数分类" class="headerlink" title="窗口函数分类"></a>窗口函数分类</h2><h3 id="序号函数"><a href="#序号函数" class="headerlink" title="序号函数"></a>序号函数</h3><ul><li>**ROW_NUMBER()**：给结果集中的每一行分配一个唯一整数标识符，通常用于返回结果集的前几行或者给结果集进行排序。</li><li>**RANK()**：按照指定的列对结果集进行排名，排名相同的行将得到相同的排名值，而空值会被跳过。</li><li>**DENSE_RANK()**：与 RANK() 类似，但是排名相同的行不会得到相同的排名值，排名值之间没有间隔，因此该函数常用于结果集较小的情况下。</li></ul><h3 id="分布函数"><a href="#分布函数" class="headerlink" title="分布函数"></a>分布函数</h3><ul><li>**PERCENT_RANK()**：计算结果集中每一行在整个排序结果中所处的百分位，返回值为 0 到 1 之间的一个实数。</li><li>**CUME_DIST()**：计算结果集中每一行的累积分布函数的值，即该行排名的最终百分比。</li></ul><h3 id="前后函数"><a href="#前后函数" class="headerlink" title="前后函数"></a>前后函数</h3><ul><li>**LAG()**：获取某一行前面的某一列的值，可以使用 OFFSET 子句来指定前面第几行，默认为 1。</li><li>**LEAD()**：获取某一行后面的某一列的值，也可以使用 OFFSET 子句来指定后面第几行，默认为 1。</li></ul><h3 id="头尾函数"><a href="#头尾函数" class="headerlink" title="头尾函数"></a>头尾函数</h3><ul><li>**FIRST_VALUE()**：获取某一列的第一个值。</li><li>**LAST_VALUE()**：获取某一列的最后一个值。</li></ul><h3 id="其它函数"><a href="#其它函数" class="headerlink" title="其它函数"></a>其它函数</h3><ul><li>**NTH_VALUE()**：获取某一列的第 N 个值，可以使用 OFFSET 子句来指定第几个值。</li><li>**NTILE()**：将结果集划分成指定数量的桶，每个桶中包含相等数量的行，并返回桶号。</li></ul><h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><h2 id="定义条件"><a href="#定义条件" class="headerlink" title="定义条件"></a>定义条件</h2><p>（1）定义条件就是给MySQL中的错误码命名，这有助于存储的程序代码更清晰</p><p>（2）定义条件语法格式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> 错误名称 <span class="keyword">condition</span> <span class="keyword">for</span> 错误码（或错误条件）</span><br></pre></td></tr></table></figure><h2 id="定义处理程序"><a href="#定义处理程序" class="headerlink" title="定义处理程序"></a>定义处理程序</h2><p>（1）可以为SQL执行过程中发生的某种类型的错误定义特殊的处理程序</p><p>（2）定义处理程序语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> 处理方式 handler <span class="keyword">for</span> 错误类型 处理语句  </span><br></pre></td></tr></table></figure><p>（3）处理方式：处理方式有3个取值：CONTINUE、EXIT、UNDO。</p><table><thead><tr><th>方式</th><th>简介</th></tr></thead><tbody><tr><td>CONTINUE</td><td>表示遇到错误不处理，继续执行</td></tr><tr><td>EXIT</td><td>表示遇到错误马上退出</td></tr><tr><td>UNDO</td><td>表示遇到错误后撤回之前的操作。MySQL中暂时不支持这样的操作。</td></tr></tbody></table><p>（4）错误类型（即条件）可以有如下取值：</p><table><thead><tr><th>类型</th><th>简介</th></tr></thead><tbody><tr><td>SQLSTATE ‘字符串错误码’</td><td>表示长度为5的sqlstate_value类型的错误代码；</td></tr><tr><td><strong>MySQL_error_code</strong></td><td>匹配数值类型错误代码；</td></tr><tr><td>错误名称</td><td>表示<strong>declare</strong> … <strong>condition</strong>定义的错误条件名称。</td></tr><tr><td>SQLWARNING</td><td>匹配所有以01开头的SQLSTATE错误代码；</td></tr><tr><td>NOT FOUND</td><td>匹配所有以02开头的SQLSTATE错误代码；</td></tr><tr><td>SQLEXCEPTION</td><td>匹配所有没有被SQLWARNING或NOT FOUND捕获的SQLSTATE错误代码；</td></tr></tbody></table><h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><h2 id="顺序结构"><a href="#顺序结构" class="headerlink" title="顺序结构"></a>顺序结构</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">	语句或语句块</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h2 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h2><h3 id="分支结构之-IF"><a href="#分支结构之-IF" class="headerlink" title="分支结构之 IF"></a>分支结构之 IF</h3><p>（1）语法结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if 表达式<span class="number">1</span> </span><br><span class="line">	<span class="keyword">then</span> 操作<span class="number">1</span></span><br><span class="line">elseif 表达式<span class="number">2</span> </span><br><span class="line">	<span class="keyword">then</span> 操作<span class="number">2</span></span><br><span class="line">	……</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">	操作N</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure><p>（2）举例</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> test_if()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> age <span class="type">INT</span> <span class="keyword">default</span> <span class="number">20</span>;</span><br><span class="line">	if  age <span class="operator">&gt;</span> <span class="number">60</span></span><br><span class="line">		<span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;中老年&#x27;</span>;</span><br><span class="line">	elseif  age <span class="operator">&gt;</span> <span class="number">18</span></span><br><span class="line">		<span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;青壮年&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="string">&#x27;未成年&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter;</span><br></pre></td></tr></table></figure><h3 id="分支结构之-CASE"><a href="#分支结构之-CASE" class="headerlink" title="分支结构之 CASE"></a>分支结构之 CASE</h3><p>（1）语法结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> [表达式]</span><br><span class="line">	<span class="keyword">when</span> 条件<span class="number">1</span> <span class="keyword">then</span> 结果<span class="number">1</span>或语句<span class="number">1</span>(如果是语句，需要加分号)</span><br><span class="line">	<span class="keyword">when</span> 条件<span class="number">2</span> <span class="keyword">then</span> 结果<span class="number">2</span>或语句<span class="number">2</span>(如果是语句，需要加分号)    </span><br><span class="line">	……</span><br><span class="line">	[ <span class="keyword">else</span> 结果n或语句n(如果是语句，需要加分号)]</span><br><span class="line"><span class="keyword">end</span> [<span class="keyword">case</span>]（如果是放在<span class="keyword">begin</span> <span class="keyword">end</span>中需要加上<span class="keyword">case</span>，如果放在<span class="keyword">select</span>后面不需要）</span><br></pre></td></tr></table></figure><p>（2）案例1：查询user表中 参数选手名称 与 获得的奖牌（根据分数判断）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">uname,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> ucredit<span class="operator">&gt;=</span><span class="number">200</span> <span class="keyword">then</span> <span class="string">&#x27;金牌选手&#x27;</span></span><br><span class="line">    <span class="keyword">when</span> ucredit<span class="operator">&gt;=</span><span class="number">100</span> <span class="keyword">then</span> <span class="string">&#x27;银牌选手&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="string">&#x27;铜牌选手&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> users limit <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>（3）案例2：判断val值等于1、等于2，或者两者都不等。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> test_case(<span class="keyword">IN</span> var <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">case</span> var</span><br><span class="line">		<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;var = 1&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;var = 2&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">3</span> <span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;var = 3&#x27;</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">select</span> <span class="string">&#x27;其他数字&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter;</span><br></pre></td></tr></table></figure><h2 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h2><h3 id="循环结构之-LOOP"><a href="#循环结构之-LOOP" class="headerlink" title="循环结构之 LOOP"></a>循环结构之 LOOP</h3><blockquote><p>LOOP循环语句用来重复执行某些语句，直到循环被退出（使用LEAVE子 句），跳出循环过程。</p></blockquote><p>（1）语法结构（loop_label表示LOOP语句的标注名称）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[loop_label:] loop </span><br><span class="line">	循环执行的语句 </span><br><span class="line"><span class="keyword">end</span> loop [loop_label]</span><br></pre></td></tr></table></figure><p>（2）案例</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> test_loop()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	# 声明局部变量num</span><br><span class="line">	<span class="keyword">declare</span> num <span class="type">INT</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line">	# 使用循环结构loop</span><br><span class="line">	loop_label:loop</span><br><span class="line">		# 对num重新赋值</span><br><span class="line">		<span class="keyword">SET</span> num <span class="operator">=</span> num <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		# 如果num大于<span class="number">10</span>则跳出循环</span><br><span class="line">		if num <span class="operator">&gt;=</span> <span class="number">10</span> </span><br><span class="line">			<span class="keyword">then</span> leave loop_label;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">	<span class="keyword">end</span> loop loop_label;</span><br><span class="line">	#查看num</span><br><span class="line">	<span class="keyword">SELECT</span> num;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h3 id="循环结构之-WHILE"><a href="#循环结构之-WHILE" class="headerlink" title="循环结构之 WHILE"></a>循环结构之 WHILE</h3><blockquote><p>WHILE循环是带条件判断的循环过程。对指定的表达式进行判断，如果为真，就执行循环内的语句，否则退出循环</p></blockquote><p>（1）语法结构（while_label为WHILE语句的标注名称）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[while_label:] while 循环条件 do</span><br><span class="line">	循环体</span><br><span class="line"><span class="keyword">end</span> while [while_label];</span><br></pre></td></tr></table></figure><p>（2）案例：当 i 值小于等于10时，将重复执行循环过程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> test_while()</span><br><span class="line"><span class="keyword">begin</span>	</span><br><span class="line">	# 声明局部变量num</span><br><span class="line">	<span class="keyword">declare</span> num <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line">	#循环条件</span><br><span class="line">	while num <span class="operator">&lt;=</span> <span class="number">10</span> do</span><br><span class="line">		#循环体（略）</span><br><span class="line">	#迭代条件</span><br><span class="line">	<span class="keyword">set</span> num <span class="operator">=</span> num <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">end</span> while;</span><br><span class="line">	#查询</span><br><span class="line">	<span class="keyword">select</span> num;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h3 id="循环结构之-REPEAT"><a href="#循环结构之-REPEAT" class="headerlink" title="循环结构之 REPEAT"></a>循环结构之 REPEAT</h3><blockquote><p>REPEAT语句创建一个带条件判断的循环过程。与WHILE循环不同的是，REPEAT 循环首先会执行一次循环，然后在 UNTIL 中进行表达式的判断，如果满足条件就退出，即 END REPEAT；如果条件不满足，则会就继续执行循环，直到满足退出条件为止。</p></blockquote><p>（1）语法结构（repeat_label为REPEAT语句的标注名称）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[repeat_label:] repeat</span><br><span class="line">	循环体的语句</span><br><span class="line">until 结束循环的条件表达式</span><br><span class="line"><span class="keyword">end</span> repeat [repeat_label]</span><br></pre></td></tr></table></figure><p>（2）案例：不满足 i 值大于或等于10时，将重复执行循环体</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> test_repeat()</span><br><span class="line"><span class="keyword">begin</span>	</span><br><span class="line">	# 声明局部变量num</span><br><span class="line">	<span class="keyword">declare</span> num <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;</span><br><span class="line">	# 使用循环结构REPEAT</span><br><span class="line">	repeat</span><br><span class="line">		# 循环体的语句</span><br><span class="line">		<span class="keyword">SET</span> num <span class="operator">=</span> num <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		# 不满足就继续执行循环体</span><br><span class="line">		until num <span class="operator">&gt;=</span> <span class="number">10</span></span><br><span class="line">	<span class="keyword">end</span> repeat;</span><br><span class="line">	#查看</span><br><span class="line">	<span class="keyword">SELECT</span> num;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="跳转语句"><a href="#跳转语句" class="headerlink" title="跳转语句"></a>跳转语句</h2><h3 id="跳转语句之-LEAVE语句"><a href="#跳转语句之-LEAVE语句" class="headerlink" title="跳转语句之 LEAVE语句"></a>跳转语句之 LEAVE语句</h3><blockquote><p>LEAVE语句：可以用在循环语句内，或者以 BEGIN 和 END 包裹起来的程序体内，表示跳出循环或者跳出程序体的操作。（类似其他语言的<code>break</code>）</p></blockquote><p>（1）语法结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leave 标记名</span><br></pre></td></tr></table></figure><p>（2）案例：创建存储过程 “leave_begin()”，声明INT类型的IN参数num。给BEGIN…END加标记名，并在 BEGIN…END中使用IF语句判断num参数的值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 如果num<span class="operator">&lt;=</span><span class="number">0</span>，则使用LEAVE语句退出BEGIN...END；</span><br><span class="line"># 如果num<span class="operator">=</span><span class="number">1</span>，则查询“employees”表的平均薪资；</span><br><span class="line"># 如果num<span class="operator">=</span><span class="number">2</span>，则查询“employees”表的最低薪资；</span><br><span class="line"># 如果num<span class="operator">&gt;</span><span class="number">2</span>，则查询“employees”表的最高薪资。</span><br><span class="line"># IF语句结束后查询“employees”表的总人数。</span><br><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> leave_begin(<span class="keyword">IN</span> num <span class="type">INT</span>)</span><br><span class="line">begin_label:<span class="keyword">begin</span></span><br><span class="line">	if num <span class="operator">&lt;=</span> <span class="number">0</span></span><br><span class="line">		<span class="keyword">then</span> leave begin_label;</span><br><span class="line">	elseif num <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">		<span class="keyword">then</span> <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line">	elseif num <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">		<span class="keyword">then</span> <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line">	<span class="keyword">end</span> if;</span><br><span class="line">	#查询总人数</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h3 id="跳转语句之-ITERATE语句"><a href="#跳转语句之-ITERATE语句" class="headerlink" title="跳转语句之 ITERATE语句"></a>跳转语句之 ITERATE语句</h3><blockquote><p>ITERATE语句：只能用在循环语句（LOOP、REPEAT和WHILE语句）内，表示重新开始循环，将执行顺序 转到语句段开头处，意思为“再次循环”。（类似其他语言的<code>continue</code>）</p></blockquote><p>（1）语法结构（ITERATE语句必须跟在循环标志前面。label参数表示循环的标志）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iterate label</span><br></pre></td></tr></table></figure><p>（2）案例：定义局部变量num，初始值为0。循环结构中执行num + 1操作。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 如果num <span class="operator">&lt;</span> <span class="number">10</span>，则继续执行循环； </span><br><span class="line"># 如果num <span class="operator">&gt;</span> <span class="number">15</span>，则退出循环结构；</span><br><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span>  test_iterate()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> num <span class="type">INT</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	loop_label:loop</span><br><span class="line">		#赋值</span><br><span class="line">		<span class="keyword">set</span> num <span class="operator">=</span> num <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		# 如果小于<span class="number">10</span>，则继续执行循环； </span><br><span class="line">		if num  <span class="operator">&lt;</span> <span class="number">10</span></span><br><span class="line">			<span class="keyword">then</span> iterate loop_label;</span><br><span class="line">		# 如果大于<span class="number">15</span>，则退出循环结构；</span><br><span class="line">		elsef num <span class="operator">&gt;</span> <span class="number">15</span></span><br><span class="line">			<span class="keyword">then</span> leave loop_label;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		# 当num为<span class="number">0</span><span class="number">-9</span>时都会重新开始循环（iterate），当num为<span class="number">10</span><span class="number">-15</span>时会执行到此语句，直到num大于<span class="number">15</span>时，结束循环（leave）</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="string">&#x27;此句会执行6次&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h1 id="事件（event）"><a href="#事件（event）" class="headerlink" title="事件（event）"></a>事件（event）</h1><h2 id="查看事件调度器是否开启"><a href="#查看事件调度器是否开启" class="headerlink" title="查看事件调度器是否开启"></a>查看事件调度器是否开启</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 方式一</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;event_scheduler&#x27;</span></span><br><span class="line"># 方式二</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@event</span>_scheduler;</span><br><span class="line"># 方式三</span><br><span class="line"><span class="keyword">show</span> processlist;</span><br></pre></td></tr></table></figure><h2 id="开启事件调度器"><a href="#开启事件调度器" class="headerlink" title="开启事件调度器"></a>开启事件调度器</h2><p>（1）方式一：使用set global命令可以开启或关闭事件</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> event_scheduler<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> event_scheduler<span class="operator">=</span><span class="keyword">ON</span>;</span><br></pre></td></tr></table></figure><p>（2）方式二：通过更改配置文件（始终开启事件）</p><p>需要在MySQL的配置文件my.ini（Windows系统）&#x2F;my.cnf（Linux系统）中添加event_scheduler&#x3D;on。（添加后需要重启服务）</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 事件调度器启动状态</span></span><br><span class="line"><span class="attr">event_scheduler</span> = <span class="literal">on</span></span><br></pre></td></tr></table></figure><h2 id="创建事件"><a href="#创建事件" class="headerlink" title="创建事件"></a>创建事件</h2><p>语法结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span></span><br><span class="line">	[ definer <span class="operator">=</span>&#123;<span class="keyword">user</span> <span class="operator">|</span> <span class="built_in">current_user</span> &#125;]</span><br><span class="line">	event [if <span class="keyword">not</span> <span class="keyword">exists</span>] 事件名</span><br><span class="line">	<span class="keyword">on</span> schedule schedule</span><br><span class="line">	[<span class="keyword">on</span> completion [<span class="keyword">not</span>] preserve]</span><br><span class="line">	[ enable <span class="operator">|</span> disable <span class="operator">|</span> disable <span class="keyword">on</span> slave ]</span><br><span class="line">	[ comment <span class="string">&#x27;注释内容&#x27;</span>]</span><br><span class="line">	do 执行的代码;</span><br></pre></td></tr></table></figure><p>字段说明</p><table><thead><tr><th>字段</th><th>简介</th></tr></thead><tbody><tr><td><strong>definer</strong></td><td>可选，用于定义事件执行时检查权限的用户</td></tr><tr><td><strong>on</strong> <strong>schedule</strong> schedule</td><td>必选，用于定义执行的时间和时间间隔</td></tr><tr><td>on completion [not] preserve</td><td>可选，用于定义事件是否循环执行，即是一次执行还是永久执行，默认为一次执行，即 NOT PRESERVE</td></tr><tr><td>enable | disable | disable on slave</td><td>可选项，用于指定事件的一种属性。默认活动的（enable）。 enable：表示该事件是活动的，也就是调度器检查事件是否必选调用； disable：表示该事件是关闭的，也就是事件的声明存储到目录中，但是调度器不会检查它是否应该调用； disable on slave：表示事件在从机中是关闭的。</td></tr><tr><td><strong>comment</strong> ‘注释内容’</td><td>可选，用于定义事件的注释</td></tr><tr><td><strong>do</strong> 执行的代码;</td><td>必选，用于指定事件启动时所要执行的代码。 可以是任何有效的SQL语句、存储过程或者一个计划执行的事件。 如果包含多条语句，可以使用BEGIN…END复合结构</td></tr></tbody></table><p>在<strong>on</strong> <strong>schedule</strong> 子句中，参数schedule值为一个AS子句，用于指定事件在某个时刻发生，语法格式如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 方式一</span><br><span class="line"><span class="keyword">AT</span> <span class="type">timestamp</span> [<span class="operator">+</span> <span class="type">INTERVAL</span> <span class="type">interval</span>] …</span><br><span class="line"># 方式二</span><br><span class="line"><span class="keyword">EVERY</span> <span class="type">interval</span></span><br><span class="line">[STARTS <span class="type">timestamp</span> [<span class="operator">+</span> <span class="type">INTERVAL</span> <span class="type">interval</span>] ...]</span><br><span class="line">[ENDS <span class="type">timestamp</span> [<span class="operator">+</span> <span class="type">INTERVAL</span> <span class="type">interval</span>] ...]</span><br></pre></td></tr></table></figure><p>字段说明</p><table><thead><tr><th>字段</th><th>简介</th></tr></thead><tbody><tr><td>timestamp</td><td>表示一个具体的时间点，后面加上一个时间间隔，表示在这个时间间隔后事件发生。</td></tr><tr><td>EVERY子句</td><td>用于表示事件在指定时间区间内每隔多长时间发生一次，其中 SELECT子句用于指定开始时间；ENDS子句用于指定结束时间</td></tr><tr><td>interval</td><td>表示一个从现在开始的时间，其值由一个数值和单位构成。例如，使用“4 WEEK”表示4周；</td></tr></tbody></table><p>interval参数值的语法格式如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">quantity &#123;</span><br><span class="line">	<span class="keyword">YEAR</span> <span class="operator">|</span> QUARTER <span class="operator">|</span> <span class="keyword">MONTH</span> <span class="operator">|</span> <span class="keyword">DAY</span> <span class="operator">|</span> <span class="keyword">HOUR</span> <span class="operator">|</span> <span class="keyword">MINUTE</span> <span class="operator">|</span> WEEK <span class="operator">|</span> <span class="keyword">SECOND</span> <span class="operator">|</span>YEAR_MONTH <span class="operator">|</span></span><br><span class="line">	DAY_HOUR <span class="operator">|</span> DAY_MINUTE <span class="operator">|</span> DAY_SECOND <span class="operator">|</span> HOUR_MINUTE <span class="operator">|</span> HOUR_SECOND <span class="operator">|</span> MINUTE_SECOND</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一些常用的时间间隔设置</p><table><thead><tr><th>语法</th><th>简介</th></tr></thead><tbody><tr><td>ON SCHEDULE EVERY 5 SECOND</td><td>每隔5秒钟执行</td></tr><tr><td>ON SCHEDULE EVERY 1 MINUTE</td><td>每隔1分钟执行</td></tr><tr><td>ON SCHEDULE EVERY 1 WEEK</td><td>每隔1周执行</td></tr><tr><td>ON SCHEDULE EVERY 1 DAY STARTS DATE_ADD( DATE_ADD( CURDATE(), INTERVAL 1 DAY ), INTERVAL 1 HOUR )</td><td>每天凌晨1点执行</td></tr><tr><td>ON SCHEDULE EVERY 1 MONTH STARTS DATE_ADD( DATE_ADD( DATE_SUB( CURDATE(),INTERVAL DAY(CURDATE())-1 DAY ),INTERVAL 1 MONTH ),INTERVAL 1 HOUR )</td><td>每个月的第一天凌晨1点执行</td></tr><tr><td>ON SCHEDULE EVERY 3 MONTH STARTS CURRENT_TIMESTAMP + 1 WEEK</td><td>每 3 个月，从现在起一周后开始</td></tr><tr><td>ON SCHEDULE EVERY 12 HOUR STARTS CURRENT_TIMESTAMP + INTERVAL 30 MINUTE ENDS CURRENT_TIMESTAMP + INTERVAL 4 WEEK</td><td></td></tr></tbody></table><h2 id="查询事件"><a href="#查询事件" class="headerlink" title="查询事件"></a>查询事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.events;</span><br></pre></td></tr></table></figure><h2 id="启动事件"><a href="#启动事件" class="headerlink" title="启动事件"></a>启动事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> event 事件名 enable; </span><br></pre></td></tr></table></figure><h2 id="关闭事件"><a href="#关闭事件" class="headerlink" title="关闭事件"></a>关闭事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> event 事件名 disable; </span><br></pre></td></tr></table></figure><h2 id="删除事件"><a href="#删除事件" class="headerlink" title="删除事件"></a>删除事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> event if <span class="keyword">exists</span> 事件名;</span><br></pre></td></tr></table></figure><h1 id="存储过程（procedure）"><a href="#存储过程（procedure）" class="headerlink" title="存储过程（procedure）"></a>存储过程（procedure）</h1><h2 id="改变mysql结束符"><a href="#改变mysql结束符" class="headerlink" title="改变mysql结束符"></a>改变mysql结束符</h2><p>MySQL默认的语句结束符号为分号<code>;</code> 为了避免与存储过程中SQL语句结束符相冲突，需要使用 DELIMITER改变存储过程的结束符，使用后需要指定回分号，否则后续的查询结束符都为新设置的</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 常见的新的结束符为$ 或 <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER 新的结束标记  </span><br></pre></td></tr></table></figure><p>案例：定义以$为结束符号</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> 存储过程名(<span class="keyword">IN</span><span class="operator">|</span><span class="keyword">OUT</span><span class="operator">|</span><span class="keyword">INOUT</span> 参数名 参数类型,...)</span><br><span class="line">[characteristics ...]</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">sql</span>语句<span class="number">1</span>; </span><br><span class="line">	<span class="keyword">sql</span>语句<span class="number">2</span>;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 存储过程含义：就是一组经过 预先编译 的 <span class="keyword">SQL</span> 语句 的封装</span><br><span class="line"># 与存储函数区别：存储过程是没有返回值的。</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> 存储过程名(<span class="keyword">IN</span><span class="operator">|</span><span class="keyword">OUT</span><span class="operator">|</span><span class="keyword">INOUT</span> 参数名 参数类型,...)</span><br><span class="line">[characteristics ...]</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	函数体</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>参数概括</p><table><thead><tr><th>参数</th><th>简介</th></tr></thead><tbody><tr><td>IN</td><td>当前参数为输入参数，也就是表示入参； 存储过程只是读取这个参数的值。如果没有定义参数种类， 默认就是 IN ，表示输入参数。</td></tr><tr><td>OUT</td><td>当前参数为输出参数，也就是表示出参； 执行完成之后，调用这个存储过程的客户端或者应用程序就可以读取这个参数返回的值了。</td></tr><tr><td>INOUT</td><td>当前参数既可以为输入参数，也可以为输出参数。</td></tr><tr><td>形参类型</td><td>形参类型可以是 MySQL数据库中的任意类型</td></tr><tr><td>characteristics</td><td>表示创建存储过程时指定的对存储过程的约束条件</td></tr></tbody></table><p>characteristics 表示创建存储过程时指定的对存储过程的约束条件，其取值信息如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LANGUAGE</span> <span class="keyword">SQL</span>  <span class="operator">|</span> [<span class="keyword">NOT</span>] <span class="keyword">DETERMINISTIC</span>  <span class="operator">|</span> &#123; <span class="keyword">CONTAINS</span> <span class="keyword">SQL</span> <span class="operator">|</span> <span class="keyword">NO</span>  <span class="keyword">SQL</span> <span class="operator">|</span> <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA <span class="operator">|</span> <span class="keyword">MODIFIES</span> <span class="keyword">SQL</span> DATA &#125;  <span class="operator">|</span> <span class="keyword">SQL</span> SECURITY &#123;  DEFINER <span class="operator">|</span> INVOKER &#125;  <span class="operator">|</span> COMMENT <span class="string">&#x27;string&#x27;</span>  </span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>简介</th></tr></thead><tbody><tr><td>LANGUAGE SQL</td><td>说明存储过程执行体是由SQL语句组成的，当前系统支持的语言为SQL</td></tr><tr><td>[NOT] DETERMINISTIC</td><td>指明存储过程执行的结果是否确定。 DETERMINISTIC表示结果是确定 的。每次执行存储过程时，相同的输入会得到相同的输出。 NOT DETERMINISTIC表示结果是不确定 的，相同的输入可能得到不同的输出。 如果没有指定任意一个值，默认为NOT DETERMINISTIC。</td></tr><tr><td>{ CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }</td><td>指明子程序使 用SQL语句的限制。 CONTAINS SQL：当前存储过程的子程序包含SQL语句，但是并不包含读写数据的SQL语句； NO SQL：当前存储过程的子程序中不包含任何SQL语句； READS SQL DATA表示当前存储过程的子程序中包含读数据的SQL语句； MODIFIES SQL DATA表示当前存储过程的子程序中包含写数据的SQL语句。 默认情况下，系统会指定为CONTAINS SQL</td></tr><tr><td>SQL SECURITY { DEFINER | INVOKER }</td><td>执行当前存储过程的权限，即指明哪些用户能够执 行当前存储过程。 DEFINER 表示只有当前存储过程的创建者或者定义者才能执行当前存储过程； INVOKER 表示拥有当前存储过程的访问权限的用户能够执行当前存储过程。 如果没有设置相关的值，则MySQL默认指定值为DEFINER。</td></tr><tr><td>COMMENT ‘string’</td><td>注释信息，可以用来描述存储过程</td></tr></tbody></table><h2 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a>调用存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储过程和数据库相关，如果要执行其他数据库中的存储过程，需要指定数据库名称</span><br><span class="line"><span class="keyword">call</span> 存储过程名(实参列表)</span><br></pre></td></tr></table></figure><p>案例1：调用 in 模式的参数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> 存储过程名(<span class="string">&#x27;值&#x27;</span>);</span><br></pre></td></tr></table></figure><p>案例2：调用 out 模式的参数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@name</span>; </span><br><span class="line"><span class="keyword">call</span> 存储过程名(<span class="variable">@name</span>); </span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span>;</span><br></pre></td></tr></table></figure><p>案例3：调用 inout 模式的参数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@name</span><span class="operator">=</span>值;</span><br><span class="line"><span class="keyword">call</span> 存储过程名(<span class="variable">@name</span>); </span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span>;</span><br></pre></td></tr></table></figure><h2 id="查看存储函数或存储过程"><a href="#查看存储函数或存储过程" class="headerlink" title="查看存储函数或存储过程"></a>查看存储函数或存储过程</h2><p>（1）查看存储过程和函数的创建信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数<span class="keyword">function</span> 存储过程<span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125; 存储过程或函数名;</span><br></pre></td></tr></table></figure><p>（2）查看存储过程和函数的状态信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数<span class="keyword">function</span> 存储过程<span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">show</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125;  status [<span class="keyword">like</span> <span class="string">&#x27;存储过程或函数名&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="删除存储函数或存储过程"><a href="#删除存储函数或存储过程" class="headerlink" title="删除存储函数或存储过程"></a>删除存储函数或存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># IF <span class="keyword">EXISTS</span>：如果程序或函数不存储，它可以防止发生错误，产生一个用<span class="keyword">SHOW</span> WARNINGS查看的警告</span><br><span class="line"><span class="keyword">drop</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125; [if <span class="keyword">exists</span>] 存储过程或函数的名</span><br></pre></td></tr></table></figure><h1 id="存储函数（function）"><a href="#存储函数（function）" class="headerlink" title="存储函数（function）"></a>存储函数（function）</h1><h2 id="创建存储函数"><a href="#创建存储函数" class="headerlink" title="创建存储函数"></a>创建存储函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> 函数名( 形参名 形参类型, ... )</span><br><span class="line">	<span class="keyword">returns</span> 返回值类型</span><br><span class="line">[characteristics ...]</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	函数体  #函数体中肯定有 <span class="keyword">RETURN</span> 语句</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>参数概括</p><table><thead><tr><th>参数</th><th>简介</th></tr></thead><tbody><tr><td>参数列表</td><td>包含两部分参数名和参数类型 指定参数为IN、OUT或INOUT只对PROCEDURE是合法的，FUNCTION中总是默认为IN参数。</td></tr><tr><td>returns type</td><td>表示函数返回数据的类型； RETURNS子句只能对FUNCTION做指定，对函数而言这是 强制的。 它用来指定函数的返回类型，而且函 数体必须包含一个 RETURN value 语句。</td></tr><tr><td>characteristic</td><td>创建函数时指定的对函数的约束，取值与创建存储过程时相同</td></tr><tr><td>函数体</td><td>函数体必须有return语句 且每个sql语句后要以;结尾 所以需要使用delimiter来重新设置结束标记 可以用BEGIN…END来表示SQL代码的开始和结束。如果函数体只有一条语句，也可以省略 BEGIN…END</td></tr></tbody></table><h2 id="调用存储函数"><a href="#调用存储函数" class="headerlink" title="调用存储函数"></a>调用存储函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数的使用方法与MySQL内部函数的使用方法是一样</span><br><span class="line"># 区别：存储函数是 用户自己定义 的，而内部函数是MySQL 开发者 定义</span><br><span class="line"><span class="keyword">select</span> 函数名(实参列表)</span><br></pre></td></tr></table></figure><h2 id="查看存储函数或存储过程-1"><a href="#查看存储函数或存储过程-1" class="headerlink" title="查看存储函数或存储过程"></a>查看存储函数或存储过程</h2><p>（1）查看存储过程和函数的创建信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数<span class="keyword">function</span> 存储过程<span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125; 存储过程或函数名;</span><br></pre></td></tr></table></figure><p>（2）查看存储过程和函数的状态信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数<span class="keyword">function</span> 存储过程<span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">show</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125;  status [<span class="keyword">like</span> <span class="string">&#x27;存储过程或函数名&#x27;</span>]</span><br></pre></td></tr></table></figure><h3 id="修改存储函数或存储过程"><a href="#修改存储函数或存储过程" class="headerlink" title="修改存储函数或存储过程"></a>修改存储函数或存储过程</h3><p>修改存储过程或函数，不影响存储过程或函数功能，只是修改相关特性</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 存储函数<span class="keyword">function</span> 存储过程<span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">alter</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125; 存储过程或函数名 [characteristic ...]</span><br></pre></td></tr></table></figure><p>characteristic指定存储过程或函数的特性，其取值信息与创建存储过程、函数时的取值信息略有不同。</p><p>{ CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA } | SQL SECURITY { DEFINER | INVOKER } | COMMENT ‘string’</p><p>字段概括</p><table><thead><tr><th>字段</th><th>简介</th></tr></thead><tbody><tr><td>CONTAINS SQL</td><td>表示子程序包含SQL语句，但不包含读或写数据的语句。</td></tr><tr><td>NO SQL</td><td>表示子程序中不包含SQL语句。</td></tr><tr><td>READS SQL DATA</td><td>表示子程序中包含读数据的语句。</td></tr><tr><td>MODIFIES SQL DATA</td><td>表示子程序中包含写数据的语句。</td></tr><tr><td>SQL SECURITY { DEFINER | INVOKER } ，</td><td>指明谁有权限来执行 DEFINER ，表示只有定义者自己才能够执行。 INVOKER ，表示调用者可以执行</td></tr><tr><td>COMMENT ‘string’</td><td>表示注释信息</td></tr></tbody></table><h2 id="删除存储函数或存储过程-1"><a href="#删除存储函数或存储过程-1" class="headerlink" title="删除存储函数或存储过程"></a>删除存储函数或存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># IF <span class="keyword">EXISTS</span>：如果程序或函数不存储，它可以防止发生错误，产生一个用<span class="keyword">SHOW</span> WARNINGS查看的警告</span><br><span class="line"><span class="keyword">drop</span> &#123;<span class="keyword">procedure</span><span class="operator">|</span><span class="keyword">function</span>&#125; [if <span class="keyword">exists</span>] 存储过程或函数的名</span><br></pre></td></tr></table></figure><h1 id="触发器（trigger）"><a href="#触发器（trigger）" class="headerlink" title="触发器（trigger）"></a>触发器（trigger）</h1><h2 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> 触发器名称 </span><br><span class="line">&#123; before<span class="operator">|</span>after &#125; &#123; <span class="keyword">insert</span> <span class="operator">|</span> <span class="keyword">update</span> <span class="operator">|</span> <span class="keyword">delete</span> &#125; <span class="keyword">on</span> 表名 </span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line">触发器执行的语句块;</span><br></pre></td></tr></table></figure><p>字段说明</p><table><thead><tr><th>字段</th><th>简介</th></tr></thead><tbody><tr><td>表名</td><td>表示触发器监控的对象</td></tr><tr><td>{ <strong>before</strong>|<strong>after</strong> }</td><td>表示触发的时间。 <strong>before</strong> 表示在事件之前触发；<strong>after</strong> 表示在事件之后触发</td></tr><tr><td>{ <strong>insert</strong> <strong>|</strong> <strong>update</strong> <strong>|</strong> <strong>delete</strong> }</td><td>表示触发的事件 <strong>insert</strong> 表示插入记录时触发；<strong>update</strong> 表示更新记录时触发；<strong>delete</strong> 表示删除记录时触发。</td></tr><tr><td>触发器执行的语句块</td><td>可以是单条SQL语句，也可以是由<strong>begin</strong>…**end;**结构组成的复合语句块</td></tr></tbody></table><h2 id="查看触发器"><a href="#查看触发器" class="headerlink" title="查看触发器"></a>查看触发器</h2><p>（1）查看当前数据库的所有触发器的定义</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> triggers;</span><br></pre></td></tr></table></figure><p>（2）查看当前数据库中某个触发器的定义</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">trigger</span> 触发器名</span><br></pre></td></tr></table></figure><p>（3）从系统库information_schema的TRIGGERS表中查询“salary_check_trigger”触发器的信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.TRIGGERS;</span><br></pre></td></tr></table></figure><h2 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> if <span class="keyword">exists</span> 触发器名称;</span><br></pre></td></tr></table></figure><h2 id="触发器案例"><a href="#触发器案例" class="headerlink" title="触发器案例"></a>触发器案例</h2><p>（1）创建测试表test_trigger</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_trigger (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key AUTO_INCREMENT, # 主键自增</span><br><span class="line">    t_note <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>（2）创建日志表test_trigger_log ，存放测试表test_trigger的日志</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_trigger_log (</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key AUTO_INCREMENT, # 主键自增</span><br><span class="line">	t_log <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>（3）创建名称为before_insert_test_tri的触发器，向test_trigger数据表插入数据之前，向test_trigger_log数据表中插入日志信息（固定内容）。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_insert_test_tri</span><br><span class="line">before <span class="keyword">insert</span> <span class="keyword">on</span> test_trigger</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">insert</span> <span class="keyword">into</span> test_trigger_log(t_log) <span class="keyword">values</span>(<span class="string">&#x27;before insert...&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><p>（4）测试向test_trigger表插入数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_trigger(t_note) <span class="keyword">values</span>(<span class="string">&#x27;Tom...&#x27;</span>);</span><br></pre></td></tr></table></figure><p>（5）此时test_trigger表会有插入的<code>Tom...</code>数据，但插入之前会先向test_trigger_log表插入的日志<code>before insert...</code></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://ipvb.gitee.io">wen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/">https://ipvb.gitee.io/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ipvb.gitee.io" target="_blank">远方の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/MySQL.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/15/MySQL-6-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/" title="MySQL笔记-数据备份和恢复"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/09/15/MySQL-6-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/MySQL.png" onerror='onerror=null,src="/img/404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL笔记-数据备份和恢复</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/15/MySQL-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3/" title="MySQL笔记-数据库安全相关"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/08/15/MySQL-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3/MySQL.png" onerror='onerror=null,src="/img/404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL笔记-数据库安全相关</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/" title="MySQL笔记-数据库高可用性"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-01</div><div class="title">MySQL笔记-数据库高可用性</div></div></a></div><div><a href="/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/" title="MySQL笔记-数据库应用技巧"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-15</div><div class="title">MySQL笔记-数据库应用技巧</div></div></a></div><div><a href="/2020/07/01/MySQL-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="MySQL笔记-数据库基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/07/01/MySQL-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-01</div><div class="title">MySQL笔记-数据库基础知识</div></div></a></div><div><a href="/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="MySQL笔记-数据库性能优化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-15</div><div class="title">MySQL笔记-数据库性能优化</div></div></a></div><div><a href="/2020/08/01/MySQL-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9B%B8%E5%85%B3/" title="MySQL笔记-数据库设计相关"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/08/01/MySQL-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9B%B8%E5%85%B3/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-01</div><div class="title">MySQL笔记-数据库设计相关</div></div></a></div><div><a href="/2020/07/15/MySQL-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" title="MySQL笔记-数据库常用操作"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2020/07/15/MySQL-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-15</div><div class="title">MySQL笔记-数据库常用操作</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Gitalk</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">wen</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wen53231323"><i class="fab fa-github"></i><span>我的仓库</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">暂无</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.</span> <span class="toc-text">系统变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.1.</span> <span class="toc-text">系统变量分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">常用的系统变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%88global%EF%BC%89"><span class="toc-number">1.1.3.</span> <span class="toc-text">全局系统变量（global）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%88session%EF%BC%89"><span class="toc-number">1.1.4.</span> <span class="toc-text">会话系统变量（session）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-8-0%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E2%80%94%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">1.1.5.</span> <span class="toc-text">MySQL 8.0的新特性—全局变量的持久化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">1.2.</span> <span class="toc-text">用户变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.1.</span> <span class="toc-text">用户变量分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">会话用户变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%EF%BC%88declare%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">局部用户变量（declare）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%EF%BC%88cursor%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">游标（cursor）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E6%A6%82%E6%8B%AC"><span class="toc-number">2.1.</span> <span class="toc-text">游标概括</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.</span> <span class="toc-text">游标使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">2.3.</span> <span class="toc-text">游标使用案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">内置函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text">单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.2.</span> <span class="toc-text">数值函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.3.</span> <span class="toc-text">时间日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.4.</span> <span class="toc-text">条件函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text">聚合函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">窗口函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">窗口函数简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E4%B8%8E%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%8C%BA%E5%88%AB"><span class="toc-number">4.2.</span> <span class="toc-text">聚合函数与窗口函数区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%88%86%E7%B1%BB"><span class="toc-number">4.3.</span> <span class="toc-text">窗口函数分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.1.</span> <span class="toc-text">序号函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.2.</span> <span class="toc-text">分布函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.3.</span> <span class="toc-text">前后函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B4%E5%B0%BE%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.4.</span> <span class="toc-text">头尾函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.5.</span> <span class="toc-text">其它函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">定义条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.2.</span> <span class="toc-text">定义处理程序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">6.</span> <span class="toc-text">流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.</span> <span class="toc-text">顺序结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84"><span class="toc-number">6.2.</span> <span class="toc-text">分支结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84%E4%B9%8B-IF"><span class="toc-number">6.2.1.</span> <span class="toc-text">分支结构之 IF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84%E4%B9%8B-CASE"><span class="toc-number">6.2.2.</span> <span class="toc-text">分支结构之 CASE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">6.3.</span> <span class="toc-text">循环结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8B-LOOP"><span class="toc-number">6.3.1.</span> <span class="toc-text">循环结构之 LOOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8B-WHILE"><span class="toc-number">6.3.2.</span> <span class="toc-text">循环结构之 WHILE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8B-REPEAT"><span class="toc-number">6.3.3.</span> <span class="toc-text">循环结构之 REPEAT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.4.</span> <span class="toc-text">跳转语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5%E4%B9%8B-LEAVE%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.4.1.</span> <span class="toc-text">跳转语句之 LEAVE语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5%E4%B9%8B-ITERATE%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.4.2.</span> <span class="toc-text">跳转语句之 ITERATE语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%EF%BC%88event%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">事件（event）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E4%BA%8B%E4%BB%B6%E8%B0%83%E5%BA%A6%E5%99%A8%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF"><span class="toc-number">7.1.</span> <span class="toc-text">查看事件调度器是否开启</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E4%BA%8B%E4%BB%B6%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="toc-number">7.2.</span> <span class="toc-text">开启事件调度器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.3.</span> <span class="toc-text">创建事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.4.</span> <span class="toc-text">查询事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.5.</span> <span class="toc-text">启动事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.6.</span> <span class="toc-text">关闭事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.7.</span> <span class="toc-text">删除事件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%88procedure%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">存储过程（procedure）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%8F%98mysql%E7%BB%93%E6%9D%9F%E7%AC%A6"><span class="toc-number">8.1.</span> <span class="toc-text">改变mysql结束符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.2.</span> <span class="toc-text">创建存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.3.</span> <span class="toc-text">调用存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%88%96%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.4.</span> <span class="toc-text">查看存储函数或存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%88%96%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.5.</span> <span class="toc-text">删除存储函数或存储过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%EF%BC%88function%EF%BC%89"><span class="toc-number">9.</span> <span class="toc-text">存储函数（function）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">9.1.</span> <span class="toc-text">创建存储函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">9.2.</span> <span class="toc-text">调用存储函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%88%96%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-1"><span class="toc-number">9.3.</span> <span class="toc-text">查看存储函数或存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%88%96%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">9.3.1.</span> <span class="toc-text">修改存储函数或存储过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%88%96%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-1"><span class="toc-number">9.4.</span> <span class="toc-text">删除存储函数或存储过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88trigger%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">触发器（trigger）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">10.1.</span> <span class="toc-text">创建触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">10.2.</span> <span class="toc-text">查看触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">10.3.</span> <span class="toc-text">删除触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">10.4.</span> <span class="toc-text">触发器案例</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/CSS/" title="CSS笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/01/01/CSS/CSS.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="CSS笔记"></a><div class="content"><a class="title" href="/2023/01/01/CSS/" title="CSS笔记">CSS笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/HTML/" title="HTML笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/01/01/HTML/HTML.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="HTML笔记"></a><div class="content"><a class="title" href="/2023/01/01/HTML/" title="HTML笔记">HTML笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/JavaScript/" title="JavaScript笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/01/01/JavaScript/JavaScript.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="JavaScript笔记"></a><div class="content"><a class="title" href="/2023/01/01/JavaScript/" title="JavaScript笔记">JavaScript笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/Linux/" title="Linux笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/01/01/Linux/Linux.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="Linux笔记"></a><div class="content"><a class="title" href="/2023/01/01/Linux/" title="Linux笔记">Linux笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/JavaWeb/" title="JavaWeb笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/01/01/JavaWeb/JavaWeb.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="JavaWeb笔记"></a><div class="content"><a class="title" href="/2023/01/01/JavaWeb/" title="JavaWeb笔记">JavaWeb笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By wen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '701b8bc001a40a760558',
      clientSecret: 'a51b436adc471c3949a8f41be05c2d58cccab10a',
      repo: 'Hexo-Butterfly-Comment',
      owner: 'wen53231323',
      admin: ['wen53231323'],
      id: '63bd60c52601627f262c22bf9a11ba16',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'VI32wmbmMoxvlhpTpoDBNeOk-MdYXbMMI',
      appKey: 'oFstfBFkCQIkjuk4ibCpbGqz',
      avatar: 'monsterid',
      serverURLs: 'https://vi32wmbm.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Gitalk' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>
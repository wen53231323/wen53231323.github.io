<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>MySQL笔记-数据库高可用性 | 远方の博客</title><meta name="author" content="wen"><meta name="copyright" content="wen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="主从复制主从复制的概念MySQL主从复制是一种常用的数据库复制技术，通过复制主服务器（Master）上的数据复制到另一个或多个从服务器（Slave）上，实现数据的实时同步和备份。 主从复制的作用主从复制在数据库系统中有以下几个主要作用：  读写分离：主服务器（Master）负责处理写操作（写入数据），从服务器（Slave）负责处理读操作（查询数据），可以有效分担主服务器的负载，提高系统性能和扩展性"><meta property="og:type" content="article"><meta property="og:title" content="MySQL笔记-数据库高可用性"><meta property="og:url" content="https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/index.html"><meta property="og:site_name" content="远方の博客"><meta property="og:description" content="主从复制主从复制的概念MySQL主从复制是一种常用的数据库复制技术，通过复制主服务器（Master）上的数据复制到另一个或多个从服务器（Slave）上，实现数据的实时同步和备份。 主从复制的作用主从复制在数据库系统中有以下几个主要作用：  读写分离：主服务器（Master）负责处理写操作（写入数据），从服务器（Slave）负责处理读操作（查询数据），可以有效分担主服务器的负载，提高系统性能和扩展性"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL.png"><meta property="article:published_time" content="2020-11-30T16:00:00.000Z"><meta property="article:modified_time" content="2023-09-02T17:17:08.196Z"><meta property="article:author" content="wen"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL.png"><link rel="shortcut icon" href="/blog/img/favicon.png"><link rel="canonical" href="https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//static.cloudflareinsights.com"><link rel="preconnect" href="//www.clarity.ms"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?[object Object]";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=[object Object]"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","[object Object]")</script><script defer data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;[object Object]&quot;}"></script><script>!function(t,e,c,n,a,r){t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},(a=e.createElement(n)).async=1,a.src="https://www.clarity.ms/tag/[object Object]",(r=e.getElementsByTagName(n)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><script>const GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"/blog/search.xml","preload":true,"top_n_per_article":5,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"MySQL笔记-数据库高可用性",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-09-03 01:17:08"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/img/%E5%A4%B4%E5%83%8F.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/picture/"><i class="fa-fw fas fa-images"></i><span> 图片库</span></a></li><li><a class="site-page child" href="/blog/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" href="/blog/movies/"><i class="fa-fw fas fa-video"></i><span> 视频库</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/link/"><span>导航链接</span></a></li><li><a class="site-page child" href="/blog/comment_loading/"><span>评论管理</span></a></li><li><a class="site-page child" href="/blog/custom/"><span>自定义页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL.png)"><nav id="nav"><span id="blog-info"><a href="/blog/" title="远方の博客"><span class="site-name">远方の博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/picture/"><i class="fa-fw fas fa-images"></i><span> 图片库</span></a></li><li><a class="site-page child" href="/blog/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" href="/blog/movies/"><i class="fa-fw fas fa-video"></i><span> 视频库</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/link/"><span>导航链接</span></a></li><li><a class="site-page child" href="/blog/comment_loading/"><span>评论管理</span></a></li><li><a class="site-page child" href="/blog/custom/"><span>自定义页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL笔记-数据库高可用性</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-30T16:00:00.000Z" title="发表于 2020-12-01 00:00:00">2020-12-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-02T17:17:08.196Z" title="更新于 2023-09-03 01:17:08">2023-09-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="MySQL笔记-数据库高可用性"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h1><h2 id="主从复制的概念"><a href="#主从复制的概念" class="headerlink" title="主从复制的概念"></a>主从复制的概念</h2><p>MySQL主从复制是一种常用的数据库复制技术，通过复制主服务器（Master）上的数据复制到另一个或多个从服务器（Slave）上，实现数据的实时同步和备份。</p><h2 id="主从复制的作用"><a href="#主从复制的作用" class="headerlink" title="主从复制的作用"></a>主从复制的作用</h2><p>主从复制在数据库系统中有以下几个主要作用：</p><ul><li><strong>读写分离</strong>：主服务器（Master）负责处理写操作（写入数据），从服务器（Slave）负责处理读操作（查询数据），可以有效分担主服务器的负载，提高系统性能和扩展性。</li><li><strong>高可用性</strong>：从服务器（Slave）作为主服务器的备份，可以在主服务器（Master）发生故障时，提供数据的备份和恢复功能。</li></ul><h2 id="主从复制的原理"><a href="#主从复制的原理" class="headerlink" title="主从复制的原理"></a>主从复制的原理</h2><p>主从复制中的每个连接通常会涉及三个线程：</p><ol><li><strong>Binlog输出线程</strong>：在主库上，为每个连接到主库的从库创建一个binlog输出线程。这个线程负责将主库上的数据更改操作记录（binlog）发送给相应的从库。它将binlog事件推送到对应的从库的I&#x2F;O线程。</li><li><strong>I&#x2F;O线程</strong>：在从库上，每个连接到主库的从库都有一个独立的I&#x2F;O线程。这个线程负责与主库建立连接，接收并读取主库上的binlog事件，并将其存储到从库的本地中继日志（relay log）中。</li><li><strong>SQL线程</strong>：在从库上，每个连接到主库的从库都有一个独立的SQL线程。这个线程负责从本地中继日志中读取存储的binlog事件，并将其解析并执行在从库上重放这些事件，从而实现与主库的数据同步。</li></ol><p>具体的主从复制过程如下：</p><ol><li><strong>主服务器记录二进制日志（Binary Log）</strong>：当主服务器接收到客户端的写请求时，会在执行写操作前将该操作记录到<code>二进制日志（Binary Log）</code>。</li><li><strong>从服务器尝试连接主服务器</strong>：从服务器尝试通过网络连接到主服务器</li><li><strong>主服务器接受从服务器连接请求</strong>：主服务器接收到从服务器的连接请求，并响应该请求</li><li><strong>从服务器请求同步数据</strong>：从服务器向主服务器发送一个数据同步请求，请求复制主服务器上的数据。</li><li><strong>主服务器发送二进制日志事件</strong>：如果主服务器允许该从服务器进行复制，则主服务器将存储在二进制日志中的写操作事件发送给从服务器。</li><li><strong>从服务器接收并写入中继日志（Relay log）</strong>：从服务器启动一个<code>I/O线程（io_thread）</code>，接收到并解析主服务器发来的二进制日志事件后，会将事件写入自己本地的<code>中继日志（Relay log）</code>。</li><li><strong>从服务器读取中继日志（Relay log）并应用</strong>：从服务器会创建一个<code>SQL线程（sql_thread）</code>，按照从主服务器接收到的二进制日志事件的顺序依次读取中继日志（Relay log）中的事件，并且将这些事件应用到自己的数据库中，实现数据的同步。</li><li><strong>从服务器向主服务器发送确认消息</strong>：从服务器在完成了一轮数据同步后，会向主服务器发送一个确认消息，表示已经成功完成数据同步。</li><li><strong>主服务器和从服务器之间保持心跳连接</strong>：为了保证连接的可靠性和稳定性，主服务器和从服务器之间需要不断地保持心跳连接，并且监测连接的状态，如果发现连接异常，则会进行重连。</li><li><strong>重复执行复制过程</strong>：上述步骤将不断地重复执行，以实现主从服务器之间的数据同步。</li></ol><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/主从复制原理.png" style="zoom:50%"><h2 id="主从复制常见架构"><a href="#主从复制常见架构" class="headerlink" title="主从复制常见架构"></a>主从复制常见架构</h2><h3 id="单主单从架构"><a href="#单主单从架构" class="headerlink" title="单主单从架构"></a>单主单从架构</h3><p>一个主数据库（Master）负责写操作（写入数据），一个从数据库（Slave）负责读操作（查询数据）。主数据库将写操作的日志传给从数据库，从数据库根据主数据库的日志进行数据更新。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-单主单从架构.png" style="zoom:50%"><h3 id="单主多从架构"><a href="#单主多从架构" class="headerlink" title="单主多从架构"></a>单主多从架构</h3><p>一个主数据库（Master）负责写操作（写入数据），多个从数据库（Slave）负责读操作（查询数据）。主数据库将写操作的日志传给所有从数据库，从数据库根据主数据库的日志进行数据更新。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-单主多从架构.png" style="zoom:50%"><h3 id="主-主同步架构"><a href="#主-主同步架构" class="headerlink" title="主-主同步架构"></a>主-主同步架构</h3><p>主-主架构中有两个主数据库（Master），分别用于读操作（查询数据）和写操作（写入数据）。两个主服务器之间相互复制数据更改，实现双向同步。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-主主架构.png" style="zoom:50%"><h3 id="多主单从架构"><a href="#多主单从架构" class="headerlink" title="多主单从架构"></a>多主单从架构</h3><p>多个主数据库（Master）负责写操作（写入数据），一个从数据库（Slave）负责读操作（查询数据）。主数据库之间通过复制技术同步数据，从数据库根据主数据库的数据进行读取。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-多主单从架构.png" style="zoom:50%"><h3 id="级联复制架构"><a href="#级联复制架构" class="headerlink" title="级联复制架构"></a>级联复制架构</h3><p>在级联结构中，主数据库（Master）将数据更改传输给第一层从数据库（Slave），第一层从数据库（Slave）可以作为其他层从数据库（Slave）的主服务器，继续将数据更改传输给下一层从数据库（Slave）。这种级联结构可以减少直接从属于主数据库（Master）的从数据库（Slave）数量，来减轻主数据库（Master）的压力，分散复制请求，并提高整体的复制效率。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-级联复制架构.png" style="zoom:50%"><h3 id="集群复制架构"><a href="#集群复制架构" class="headerlink" title="集群复制架构"></a>集群复制架构</h3><p>集群复制架构将多个主从复制架构组合在一起，形成一个数据库集群。每个主从复制架构负责一部分数据，通过配置和管理多个主从复制架构来实现横向扩展和高可用性。</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL主从复制-多主多从架构.png" style="zoom:50%"><h2 id="主从复制的不同模式"><a href="#主从复制的不同模式" class="headerlink" title="主从复制的不同模式"></a>主从复制的不同模式</h2><p>MySQL主从复制有以下几种常见的模式：</p><ul><li><strong>异步复制（Asynchronous Replication）</strong>：异步复制是MySQL默认的复制方式。主服务在执行完用户提交的事务后，将结果写入 binlog 日志并立即返回给客户端，并不等待从服务接收和处理复制事件。提高主服务的性能，但在主服务宕机而从服务未备份到新的 binlog 时可能会导致数据丢失。</li><li><strong>半同步复制（Semi-Synchronous Replication）</strong>：半同步复制是MySQL主从复制的另一种模式。主服务在执行完事务后，需要至少等待一个从服务确认已经接收并写入复制事件才能返回给客户端。提供了更高的数据一致性和可靠性，但也增加了主服务器的延迟。</li><li><strong>全同步复制（Synchronous Replication）</strong>：全同步复制要求主服务执行完客户端提交的事务后，等待所有从服务都接收并写入relay log后才能返回给客户端。提供了最高的数据一致性和安全性保障，但也会引入更高的延迟和性能开销。</li></ul><h2 id="并行复制机制"><a href="#并行复制机制" class="headerlink" title="并行复制机制"></a>并行复制机制</h2><p>并行复制是MySQL中用于加快主从复制速度的一种机制，允许在从库上同时应用多个来自主库的事务，以减少复制延迟。</p><ul><li><strong>传统主从复制</strong>：在传统主从复制中，从库使用 IO 线程（io_thread）接收二进制日志（Binary Log）并保存到中继日志（Relay log），当主库并行写入压力较大时，因为是顺序写入中继日志（Relay log），所以从库 IO 线程（io_thread）一般不会产生延迟。但是<code>只有单个 SQL 线程（sql_thread）来读取和应用中继日志（Relay log）</code>，导致在高并发场景下主库严重延迟。</li><li><strong>并行复制机制</strong>：在采用并行复制机制后，从库的IO线程（io_thread）仍然负责接收主库的二进制日志（Binary log）并保存到中继日志（Relay log），但会<code>将单个SQL线程（sql_thread）演化成多个Worker线程，并行读取和应用中继日志（Relay log）中的事务</code>，充分利用了硬件资源，提高了复制的效率。</li></ul><h1 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h1><h2 id="分库分表简介"><a href="#分库分表简介" class="headerlink" title="分库分表简介"></a>分库分表简介</h2><h3 id="什么是分库？"><a href="#什么是分库？" class="headerlink" title="什么是分库？"></a>什么是分库？</h3><p><strong>分库</strong>：将一个大型数据库拆分成多个小型数据库（分库）</p><h3 id="什么是分表？"><a href="#什么是分表？" class="headerlink" title="什么是分表？"></a>什么是分表？</h3><p><strong>分表</strong>：将一个大型表拆分成多个较小的表（分表）</p><h3 id="为什么分库？"><a href="#为什么分库？" class="headerlink" title="为什么分库？"></a>为什么分库？</h3><ul><li><strong>提高存储能力</strong>：随着业务的发展，数据量会不断增长，单个数据库的存储容量可能无法满足需求。通过将数据拆分到多个数据库中，从而实现更高的存储能力。</li><li><strong>提高并发能力</strong>：随着业务的发展，在高并发的场景下大量请求访问数据库，单个数据库实例可能无法处理这么多的连接，导致性能下降或响应时间延长。通过分库，可以将数据在多个数据库中分散存储，将并发压力均匀分布到多个数据库上，每个数据库负责处理一部分并发请求，提高整个系统的并发处理能力。</li><li><strong>提高可用性</strong>：随着业务的发展，系统的可用性变得尤为重要，当数据集中存储在单个数据库中时，如果该数据库出现故障，整个系统都将不可用。通过将数据分散存储到多个数据库中，即使一个数据库发生故障，其他数据库仍然可以正常运行，确保业务的连续性和可用性。</li></ul><h3 id="为什么分表？"><a href="#为什么分表？" class="headerlink" title="为什么分表？"></a>为什么分表？</h3><ul><li><strong>提高查询性能</strong>：当一个表的数据量过大时（达到几千万），B+树的高度会增高，数据库需要扫描更多的数据页来查找所需的数据，导致查询速度下降。通过分表，可以将数据分散到多个小表中，每个小表的数据量变小，从而提高查询性能。</li><li><strong>减少锁冲突</strong>：在高并发环境下，当多个用户同时对同一张表进行写操作时，可能会引发锁冲突，降低系统的并发性能。通过分表，可以将数据分散到多个小表中，减少锁冲突的可能性，提高并发性能。</li><li><strong>方便维护和备份</strong>：当数据量较大时，整张表的维护和备份可能会变得困难。通过分表，可以将数据分散到多个小表中，便于对每个小表进行维护和备份。这样可以提高维护和备份的效率，并降低出错的风险。</li></ul><h3 id="什么时候分库？"><a href="#什么时候分库？" class="headerlink" title="什么时候分库？"></a>什么时候分库？</h3><p>分库的时机主要取决于以下几个因素：</p><ul><li><strong>单库容量达到上限</strong>：MySQL单库容量的上限具体取决于数据库类型和配置，通常是在几十到几百亿条数据之间。当单个数据库的存储容量达到极限，无法再容纳更多数据时，需要考虑进行分库操作。</li><li><strong>单库并发达到上限</strong>：MySQL单库一般可以支持1万到10万的并发读写，当并发量达到2万时，可以考虑分库来分担负载，提高并发处理能力。</li><li><strong>业务拆分需求</strong>：当业务规模扩大或需要在不同地域或数据中心部署时，可以考虑根据业务功能或地理位置等因素进行数据库的拆分。这样可以提高系统的灵活性、可伸缩性和可用性。</li></ul><h3 id="什么时候分表？"><a href="#什么时候分表？" class="headerlink" title="什么时候分表？"></a>什么时候分表？</h3><p>对于MySQL的InnoDB存储引擎而言，单表最多可以存储10亿级别的数据量。单表数据量在500万左右，性能会处于最佳状态，根据阿里巴巴的《Java开发手册》的建议，当单表行数超过500万行或者单表容量超过2GB时，推荐考虑进行分表操作。</p><p>InnoDB存储引擎最小储存单元是页，一页大小就是16k，假设一行记录占用1KB空间，一棵高度为1的B+树能存放<code>16</code>条数据，大约占用<code>16 KB</code>空间；一棵高度为2的B+树能存放<code>18720</code>条数据，大约占用<code>18.72 MB</code>空间；一棵高度为3的B+树能存放<code>21902400</code>条数据，大约占用<code>21.9 GB</code>空间；B+树高度一般为1-3层，如果B+到了4层，查询的时候会增加磁盘交互的次数，SQL就会变慢。</p><h3 id="什么时候分库分表？"><a href="#什么时候分库分表？" class="headerlink" title="什么时候分库分表？"></a>什么时候分库分表？</h3><p>分库分表方案可以分为下面3种：</p><ul><li><strong>只分库不分表</strong>：单库并发达到上限，但是单表数据量不大；</li><li><strong>只分表不分库</strong>：单表数据量过大，但是单库并发没达到上限；</li><li><strong>即分库又分表</strong>：单库并发达到上限，同时单表数据量过大。</li></ul><h2 id="分库分表拆分策略"><a href="#分库分表拆分策略" class="headerlink" title="分库分表拆分策略"></a>分库分表拆分策略</h2><p>分库和分表都可以从垂直（纵向）和水平（横向）两个维度进行拆分。</p><ul><li><strong>垂直分库</strong>：将不同的业务模块或功能模块的数据存储在不同的数据库中，每个数据库负责一个或多个特定的模块。</li><li><strong>垂直分表</strong>：将一个大表根据字段的关联性进行拆分，每个拆分出来的小表只包含一部分字段。</li><li><strong>水平分库</strong>：将一个数据库中的数据水平划分到多个独立的数据库实例中，每个数据库实例负责一部分数据。</li><li><strong>水平分表</strong>：将一个大表按照行进行拆分，将不同的行分散存储在多个物理表中。</li></ul><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/分库分表.png" style="zoom:50%"><h3 id="垂直分库"><a href="#垂直分库" class="headerlink" title="垂直分库"></a>垂直分库</h3><p>垂直分库是指将一个数据库中的表按照表之间的关联性或业务模块的划分，划分到不同的数据库中。每个数据库只存储一部分表以及相关的数据，并且都有不同的表结构和数据，所有库的数据合并起来，则可以得到全量数据。这种拆分方式常见于复杂业务系统中，可以将相关性较强的数据存储在同一个数据库中，实现逻辑上的隔离，核心理念是<code>专库专用</code>。</p><ul><li><strong>业务发展初期</strong>：业务功能模块比较少，通常将业务和功能相关表放在一起，采用单个数据库来保存数据。</li><li><strong>业务发展瓶颈</strong>：当业务发展到一定程度时，单个数据库可能无法满足系统的需求，这时候可以进行垂直分库，将系统中的不同业务进行拆分，部署在不同的数据库服务器。</li></ul><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/垂直分库.png" style="zoom:50%"><h3 id="垂直分表"><a href="#垂直分表" class="headerlink" title="垂直分表"></a>垂直分表</h3><p>垂直分表是指将一个数据库中的表按照列的划分，将一个大表拆分成多个小表，每个小表只包含部分列数据。通过垂直分表，可以降低单表的数据量和索引大小，提高查询性能和维护效率。</p><ul><li><strong>拆分前</strong>：比如一张用户表（user）包含用户ID（id）、昵称（nick_name）、年龄（age）、性别（gender）、邮箱（email）、手机（phone）、城市（city）字段，其中邮箱（email）、手机（phone）、城市（city）字段不常用，可以进行垂直分表优化。</li><li><strong>拆分后</strong>：将一张用户表（user）垂直分表，拆分为用户基本信息表（user_basic_info）和用户详细信息表（user_detail_info）两张表，用户基本信息表的字段设计为：用户ID（id）、用户昵称（nick_name）、用户年龄（age）、用户性别（gender）。用户详细信息表的字段设计为：用户ID（id）、邮箱（email）、手机（phone）、国家（country）、省份（province）、城市（city）、语言（language）。</li></ul><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/垂直分表.png" style="zoom:50%"><h3 id="水平分库"><a href="#水平分库" class="headerlink" title="水平分库"></a>水平分库</h3><p>水平分库是指将数据按照一定规则划分到不同的数据库中，每个数据库存储部分数据，数据库中具有相同表，只是表中的数据集合不一样。水平分库通常用于解决数据量过大、单一数据库无法承受高负载或者提高系统的可伸缩性等场景。可以采用以下几种分割规则：</p><ul><li><p><strong>范围分割</strong>：按照某个字段的范围将数据划分到不同的数据库中。</p></li><li><p><strong>哈希分割</strong>：使用哈希函数对某个字段进行计算，根据哈希值的模或者散列结果将数据划分到不同的数据库中。哈希分割可以使数据均匀分布在各个库中，减少了热点数据的问题。</p></li><li><p><strong>范围+哈希分割</strong>：先根据某个字段的范围分割数据到不同的库中，然后在每个库内再使用哈希分割进行进一步的数据划分。这种方式可以同时考虑范围和均衡性，使得数据在不同库中有一定范围的分布且均匀。</p></li></ul><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/水平分库.png" style="zoom:50%"><h3 id="水平分表"><a href="#水平分表" class="headerlink" title="水平分表"></a>水平分表</h3><p>水平分表是指将一个表的数据按照一定规则划分到同一个数据库中的不同表中，每个表存储部分数据。水平分表通常用于解决单张表数据过大、单表查询性能下降等问题。可以采用以下几种分割规则：</p><ul><li><strong>范围分割</strong>：按照某个字段的范围将数据划分到同一个表中。</li><li><strong>哈希分割</strong>：使用哈希函数对某个字段进行计算，根据哈希值的模或者散列结果将数据划分到不同的表中。哈希分割可以使数据均匀分布在各个表中，减少了单表数据量过大的问题。</li><li><strong>范围+哈希分割</strong>：先根据某个字段的范围分割数据到不同的表中，然后在每个表内再使用哈希分割进行进一步的数据划分。这种方式可以同时考虑范围和均衡性，使得数据在不同表中有一定范围的分布且均匀。</li></ul><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/水平分表.png" style="zoom:50%"><h2 id="分库分表带来的问题"><a href="#分库分表带来的问题" class="headerlink" title="分库分表带来的问题"></a>分库分表带来的问题</h2><h3 id="分布式事务问题"><a href="#分布式事务问题" class="headerlink" title="分布式事务问题"></a>分布式事务问题</h3><ul><li><strong>问题描述</strong>：分库分表导致执行一次事务所需的数据分布在不同服务器上，传统的单库事务无法直接应用。</li><li><strong>解决思路</strong>：使用分布式事务机制来保证事务的原子性和一致性。可以采用两阶段提交（2PC）、补偿事务、Saga模式等。另外，可以利用数据库中间件或分布式事务框架来简化事务管理和实现分布式事务。</li></ul><h3 id="分布式ID问题"><a href="#分布式ID问题" class="headerlink" title="分布式ID问题"></a>分布式ID问题</h3><ul><li><strong>问题描述</strong>：在分库分表环境中，由于数据被分散到不同的节点上，生成全局唯一的ID变得更加困难，可能会导致ID冲突或者无法满足全局唯一性的需求。</li><li><strong>解决思路</strong>：使用全局唯一标识符（UUID或GUID）作为分布式ID，或者使用数据库自增ID来生成局部唯一的ID，还可以借助第三方中间件（如Snowflake、Twitter的分布式ID生成器等）来生成全局唯一的ID。</li></ul><h3 id="数据同步问题"><a href="#数据同步问题" class="headerlink" title="数据同步问题"></a>数据同步问题</h3><ul><li><strong>问题描述</strong>：分库分表后，数据的一致性和同步变得复杂。当涉及到数据更新、删除或新增时，需要确保所有相关的分片上的数据保持一致。</li><li><strong>解决思路</strong>：使用数据同步机制，如主从复制、发布&#x2F;订阅模式、异步消息队列等，将数据的变更操作传播到所有的分片中，保证数据的一致性和同步。</li></ul><h3 id="数据迁移问题"><a href="#数据迁移问题" class="headerlink" title="数据迁移问题"></a>数据迁移问题</h3><ul><li><strong>问题描述</strong>：当需要对现有的分库分表进行扩容、重构或合并时，需要进行数据迁移，这可能会引发数据一致性问题和系统停机时间长等挑战。</li><li><strong>解决思路</strong>：采用逐步迁移的方式，将部分数据从老的分片迁移到新的分片上。可以使用增量迁移或者全量迁移的策略，并且要做好数据一致性和验证工作。同时，可以利用数据同步技术来减少迁移的停机时间和对业务的影响。</li></ul><h3 id="跨节点关联查询问题"><a href="#跨节点关联查询问题" class="headerlink" title="跨节点关联查询问题"></a>跨节点关联查询问题</h3><ul><li><strong>问题描述</strong>：分库分表之后，数据可能分布在不同的节点上，此时使用关联查询（JOIN）跨多个数据库实例或表的数据时，会增加复杂性和性能开销。</li><li><strong>解决思路</strong>：可以分多次查询进行数据组装实现业务，避免使用关联查询（JOIN）。或者在分片中的表中增加冗余字段，避免关联查询（JOIN）用空间换时间。</li></ul><h3 id="跨节点分页问题"><a href="#跨节点分页问题" class="headerlink" title="跨节点分页问题"></a>跨节点分页问题</h3><ul><li><strong>问题描述</strong>：在分库分表的环境下，进行跨节点的分页查询需要从多个分片获取数据，并对结果进行合并和排序，增加了网络传输和计算开销。</li><li><strong>解决思路</strong>：使用全局排序键，将排序键作为分片键的一部分，以保证全局有序。可以通过预取数据、并行查询等方式提高分页查询性能。同时，可以采用分页缓存技术，在应用层缓存整个分页数据，减少跨分片查询的次数。</li></ul><h3 id="跨节点排序问题"><a href="#跨节点排序问题" class="headerlink" title="跨节点排序问题"></a>跨节点排序问题</h3><ul><li><strong>问题描述</strong>：在分库分表环境中，对全局数据进行排序比较困难，需要合并多个分片的结果集，增加了计算和网络开销。</li><li><strong>解决思路</strong>：使用分布式排序算法，如归并排序、快速排序等。可以将排序操作下推至分片进行局部排序，然后通过合并操作得到全局有序结果。另外，还可以在应用层进行排序，将排序操作由数据库转移到应用程序中。</li></ul><h3 id="跨节点函数计算问题"><a href="#跨节点函数计算问题" class="headerlink" title="跨节点函数计算问题"></a>跨节点函数计算问题</h3><ul><li><strong>问题描述</strong>：在分库分表环境中，当需要进行跨节点的函数计算时，可能会面临调用多个节点的函数和结果合并等挑战。</li><li><strong>解决思路</strong>：可以将函数计算下推至分片进行局部计算，然后通过合并操作得到最终的结果。另外，还可以在应用层进行函数计算，将计算操作由数据库转移到应用程序中。</li></ul><h1 id="数据库中间件"><a href="#数据库中间件" class="headerlink" title="数据库中间件"></a>数据库中间件</h1><ul><li><strong>ShardingJDBC</strong>：基于AOP原理，在应用程序中对本地执行的SQL进行拦截，解析、改写、路由处 理。需要自行编码配置实现，只支持java语言，性能较高。</li><li><strong>MyCat</strong>：数据库分库分表中间件，不用调整代码即可实现分库分表，支持多种语言，性能不及前 者。</li></ul><h2 id="分表分库中间件"><a href="#分表分库中间件" class="headerlink" title="分表分库中间件"></a>分表分库中间件</h2><h3 id="Mycat"><a href="#Mycat" class="headerlink" title="Mycat"></a>Mycat</h3><p>Mycat是一个成熟稳定的分布式数据库中间件，在互联网和大数据场景下得到广泛应用，支持对 MySQL 和 MariaDB 进行分库分表操作。它提供了分片、读写分离和并行查询等功能，并且可以通过配置简化应用程序对数据库的访问。</p><ol><li><strong>分片和路由</strong>：Mycat支持水平分片和垂直分片两种方式的数据切分。可以根据业务需求设置分片规则，将数据分布在多个数据库节点上，并实现自动的数据路由，确保查询请求按照正确的路由规则被发送到目标节点。</li><li><strong>读写分离</strong>：Mycat支持主从复制和读写分离，可以将读请求路由到从数据库，实现负载均衡和提高系统的整体性能。同时，Mycat还提供了灵活的读写分离策略配置，可以根据业务需求进行定制。</li><li><strong>分布式事务</strong>：Mycat支持基于XA规范的分布式事务，可以确保在跨多个数据库节点的操作中，数据的一致性和隔离性。同时，Mycat还提供了TCC（Try-Confirm-Cancel）模式的分布式事务支持，用于一些无法使用XA进行全局一致性控制的场景。</li><li><strong>数据分布和复制</strong>：Mycat支持数据自动分布和复制功能，可以根据分片规则将数据按需拆分到多个节点，并实现数据的自动同步和复制，保证数据的一致性。</li><li><strong>高可用性和故障转移</strong>：Mycat提供了故障检测和自动切换功能，当数据库节点发生故障时，可以自动将请求切换到其他可用节点，确保系统的高可用性。</li><li><strong>数据监控和管理</strong>：Mycat提供了丰富的监控指标和管理界面，可以实时监控数据库节点的状态、性能指标和负载情况，便于运维人员进行系统的管理和调优。</li></ol><h3 id="ShardingSphere"><a href="#ShardingSphere" class="headerlink" title="ShardingSphere"></a>ShardingSphere</h3><p>ShardingSphere是一款开源的分布式数据库中间件，具有良好的生态系统，支持与Spring、MyBatis等主流框架无缝集成，便于开发者在应用中快速引入和使用。它广泛应用于互联网、电商、金融等行业的分布式系统中，为大规模数据处理和高并发场景提供了可靠的解决方案。旨在提供高性能、易用性和可伸缩性的分库分表解决方案。它支持多种关系型数据库（如MySQL、Oracle、SQL Server等）和NoSQL数据库（如MongoDB），并提供了全面的数据分片、读写分离、分布式事务和数据治理功能。</p><ol><li><strong>数据分片</strong>：ShardingSphere支持水平分片和垂直分片两种方式的数据切分。可以根据业务需求定义分片规则，将数据分布在多个数据库节点上，实现数据的横向拆分。</li><li><strong>读写分离</strong>：ShardingSphere支持主从复制和读写分离，可以将读请求路由到从数据库实现负载均衡和提高系统的吞吐量。</li><li><strong>分布式事务</strong>：ShardingSphere提供了基于XA规范和本地事务的分布式事务支持。可以确保在跨多个数据库节点的操作中，数据的一致性和隔离性。</li><li><strong>数据治理</strong>：ShardingSphere提供了强大的数据治理功能，包括动态数据源和分片规则配置、运行时参数调整以及监控统计等。通过这些功能，可以便捷地管理和维护分布式数据库环境。</li><li><strong>跨库查询</strong>：ShardingSphere支持在分片环境下进行跨库查询，它可以自动将查询请求发送到相关的数据库节点，并将结果进行聚合返回。</li><li><strong>数据加密和脱敏</strong>：ShardingSphere提供了数据加密和脱敏功能，可以对敏感数据进行加密保护和数据脱敏处理，确保数据安全性和隐私保护。</li></ol><h3 id="TDDL"><a href="#TDDL" class="headerlink" title="TDDL"></a>TDDL</h3><p>TDDL（Taobao Distributed Data Layer）是淘宝基于自身业务需求开发的一款分布式数据库中间件，用于实现数据库的水平拆分和读写分离，以满足高并发、大规模数据访问的需求。它支持对业务无感知的读写分离和分片功能，可以将数据按照规则分散到不同的数据库节点上，并提供了自动化的故障切换和扩缩容功能。</p><ol><li><strong>数据分片</strong>：TDDL支持垂直切分和水平切分两种方式的数据分片。可以根据业务需求和分片策略将数据分布在多个数据库节点上，实现数据的分散存储和查询请求的路由。</li><li><strong>读写分离</strong>：TDDL支持主从复制和读写分离机制，将读请求路由到从数据库节点，实现负载均衡和提升系统的整体性能。</li><li><strong>分布式事务</strong>：TDDL提供了分布式事务管理功能，支持基于XA规范的分布式事务操作，确保数据在多个数据库节点之间的一致性和隔离性。</li><li><strong>动态扩容和缩容</strong>：TDDL支持在线的动态扩容和缩容操作，可以根据业务负载情况动态添加或移除数据库节点，实现系统的弹性伸缩。</li><li><strong>全局索引和跨库分页</strong>：TDDL提供了全局索引和跨库分页的功能，使得在分片环境下进行高效的全局查询变得更加便捷。</li><li><strong>多种分片策略</strong>：TDDL支持多种分片策略，包括基于范围、散列和枚举等方式的切分，可以根据不同的业务场景选择最适合的分片策略。</li></ol><h2 id="数据增量订阅与消费中间件"><a href="#数据增量订阅与消费中间件" class="headerlink" title="数据增量订阅与消费中间件"></a>数据增量订阅与消费中间件</h2><h3 id="Canal"><a href="#Canal" class="headerlink" title="Canal"></a>Canal</h3><p>Canal是阿里巴巴开源的一款基于MySQL二进制日志的数据增量订阅与消费中间件，可以将MySQL的binlog解析成增量的数据变更事件，供上游应用消费。</p><h2 id="数据库同步中间件"><a href="#数据库同步中间件" class="headerlink" title="数据库同步中间件"></a>数据库同步中间件</h2><h3 id="DBSyncer"><a href="#DBSyncer" class="headerlink" title="DBSyncer"></a>DBSyncer</h3><p>DBSyncer是一款开源的数据同步中间件，提供MySQL、Oracle、SqlServer、PostgreSQL、Elasticsearch(ES)、Kafka、File、SQL等同步场景。支持上传插件自定义同步转换业务，提供监控全量和增量数据统计图、应用性能预警等。</p><h3 id="Otter"><a href="#Otter" class="headerlink" title="Otter"></a>Otter</h3><p>Otter是阿里巴巴开源的一款数据同步工具，主要用于数据库之间的数据迁移和同步，支持增量数据同步和全量数据同步。它提供了可靠的数据复制和变更追踪，适用于多种数据库系统。</p><h2 id="数据迁移中间件"><a href="#数据迁移中间件" class="headerlink" title="数据迁移中间件"></a>数据迁移中间件</h2><h3 id="Kettle"><a href="#Kettle" class="headerlink" title="Kettle"></a>Kettle</h3><p>Kettle 是一款国外开源的 ETL 工具，纯 Java 编写，绿色无需安装，数据抽取高效稳定 (数据迁移工具)。Kettle提供了一个图形化的界面，使用户能够使用可视化的方式设计和管理ETL流程。它支持各种数据源，包括关系型数据库、平面文件、XML、JSON等，以及各种数据处理操作，如数据清洗、转换、映射、聚合等。</p><h3 id="DataX"><a href="#DataX" class="headerlink" title="DataX"></a>DataX</h3><p>DataX是阿里巴巴集团开源的一款通用数据交换框架，支持各种异构数据源之间的数据同步和迁移。致力于实现包括关系型数据库 MySQL、Oracle、SqlServer、Postgre、HDFS、Hive、ADS、HBase、TableStore(OTS)、MaxCompute(ODPS)、DRDS等各种异结构数据源之间稳定高效的数据同步功能</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://w_e_n.gitee.io/blog">wen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/">https://w_e_n.gitee.io/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://w_e_n.gitee.io/blog" target="_blank">远方の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="/blog/2020/12/01/MySQL-11-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7/MySQL.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/" title="MySQL笔记-数据库应用技巧"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/MySQL.png" onerror='onerror=null,src="/blog/img/404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL笔记-数据库应用技巧</div></div></a></div><div class="next-post pull-right"><a href="/blog/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="MySQL笔记-数据库性能优化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/MySQL.png" onerror='onerror=null,src="/blog/img/404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL笔记-数据库性能优化</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/blog/2020/07/01/MySQL-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="MySQL笔记-数据库基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/07/01/MySQL-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-01</div><div class="title">MySQL笔记-数据库基础知识</div></div></a></div><div><a href="/blog/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="MySQL笔记-数据库性能优化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/11/15/MySQL-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-15</div><div class="title">MySQL笔记-数据库性能优化</div></div></a></div><div><a href="/blog/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/" title="MySQL笔记-数据库应用技巧"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/12/15/MySQL-12-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-15</div><div class="title">MySQL笔记-数据库应用技巧</div></div></a></div><div><a href="/blog/2020/08/01/MySQL-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9B%B8%E5%85%B3/" title="MySQL笔记-数据库设计相关"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/08/01/MySQL-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9B%B8%E5%85%B3/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-01</div><div class="title">MySQL笔记-数据库设计相关</div></div></a></div><div><a href="/blog/2020/07/15/MySQL-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" title="MySQL笔记-数据库常用操作"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/07/15/MySQL-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-15</div><div class="title">MySQL笔记-数据库常用操作</div></div></a></div><div><a href="/blog/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/" title="MySQL笔记-数据库编程相关"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2020/09/01/MySQL-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/MySQL.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-01</div><div class="title">MySQL笔记-数据库编程相关</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Gitalk</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/img/%E5%A4%B4%E5%83%8F.png" onerror='this.onerror=null,this.src="/blog/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">wen</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">62</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wen53231323"><i class="fab fa-github"></i><span>我的仓库</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">暂无</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">主从复制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">主从复制的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">主从复制的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">主从复制的原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%B8%B8%E8%A7%81%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.</span> <span class="toc-text">主从复制常见架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%B8%BB%E5%8D%95%E4%BB%8E%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.1.</span> <span class="toc-text">单主单从架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%B8%BB%E5%A4%9A%E4%BB%8E%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.2.</span> <span class="toc-text">单主多从架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB-%E4%B8%BB%E5%90%8C%E6%AD%A5%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.3.</span> <span class="toc-text">主-主同步架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%BB%E5%8D%95%E4%BB%8E%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.4.</span> <span class="toc-text">多主单从架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A7%E8%81%94%E5%A4%8D%E5%88%B6%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.5.</span> <span class="toc-text">级联复制架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%A4%8D%E5%88%B6%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.6.</span> <span class="toc-text">集群复制架构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E4%B8%8D%E5%90%8C%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">主从复制的不同模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6%E6%9C%BA%E5%88%B6"><span class="toc-number">1.6.</span> <span class="toc-text">并行复制机制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-number">2.</span> <span class="toc-text">分库分表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.</span> <span class="toc-text">分库分表简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%BA%93%EF%BC%9F"><span class="toc-number">2.1.1.</span> <span class="toc-text">什么是分库？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E8%A1%A8%EF%BC%9F"><span class="toc-number">2.1.2.</span> <span class="toc-text">什么是分表？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%86%E5%BA%93%EF%BC%9F"><span class="toc-number">2.1.3.</span> <span class="toc-text">为什么分库？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%86%E8%A1%A8%EF%BC%9F"><span class="toc-number">2.1.4.</span> <span class="toc-text">为什么分表？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%BA%93%EF%BC%9F"><span class="toc-number">2.1.5.</span> <span class="toc-text">什么时候分库？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E8%A1%A8%EF%BC%9F"><span class="toc-number">2.1.6.</span> <span class="toc-text">什么时候分表？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%EF%BC%9F"><span class="toc-number">2.1.7.</span> <span class="toc-text">什么时候分库分表？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%8B%86%E5%88%86%E7%AD%96%E7%95%A5"><span class="toc-number">2.2.</span> <span class="toc-text">分库分表拆分策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E5%88%86%E5%BA%93"><span class="toc-number">2.2.1.</span> <span class="toc-text">垂直分库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E5%88%86%E8%A1%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">垂直分表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E5%88%86%E5%BA%93"><span class="toc-number">2.2.3.</span> <span class="toc-text">水平分库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E5%88%86%E8%A1%A8"><span class="toc-number">2.2.4.</span> <span class="toc-text">水平分表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.</span> <span class="toc-text">分库分表带来的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.1.</span> <span class="toc-text">分布式事务问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8FID%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.2.</span> <span class="toc-text">分布式ID问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.3.</span> <span class="toc-text">数据同步问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.4.</span> <span class="toc-text">数据迁移问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E8%8A%82%E7%82%B9%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.5.</span> <span class="toc-text">跨节点关联查询问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E8%8A%82%E7%82%B9%E5%88%86%E9%A1%B5%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.6.</span> <span class="toc-text">跨节点分页问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E8%8A%82%E7%82%B9%E6%8E%92%E5%BA%8F%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.7.</span> <span class="toc-text">跨节点排序问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E8%8A%82%E7%82%B9%E5%87%BD%E6%95%B0%E8%AE%A1%E7%AE%97%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.8.</span> <span class="toc-text">跨节点函数计算问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">数据库中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E8%A1%A8%E5%88%86%E5%BA%93%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">分表分库中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mycat"><span class="toc-number">3.1.1.</span> <span class="toc-text">Mycat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ShardingSphere"><span class="toc-number">3.1.2.</span> <span class="toc-text">ShardingSphere</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TDDL"><span class="toc-number">3.1.3.</span> <span class="toc-text">TDDL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%A2%9E%E9%87%8F%E8%AE%A2%E9%98%85%E4%B8%8E%E6%B6%88%E8%B4%B9%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.2.</span> <span class="toc-text">数据增量订阅与消费中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Canal"><span class="toc-number">3.2.1.</span> <span class="toc-text">Canal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">数据库同步中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DBSyncer"><span class="toc-number">3.3.1.</span> <span class="toc-text">DBSyncer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Otter"><span class="toc-number">3.3.2.</span> <span class="toc-text">Otter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">数据迁移中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kettle"><span class="toc-number">3.4.1.</span> <span class="toc-text">Kettle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DataX"><span class="toc-number">3.4.2.</span> <span class="toc-text">DataX</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/01/01/CSS/" title="CSS笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2023/01/01/CSS/CSS.png" onerror='this.onerror=null,this.src="/blog/img/404.png"' alt="CSS笔记"></a><div class="content"><a class="title" href="/blog/2023/01/01/CSS/" title="CSS笔记">CSS笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/01/01/HTML/" title="HTML笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2023/01/01/HTML/HTML.png" onerror='this.onerror=null,this.src="/blog/img/404.png"' alt="HTML笔记"></a><div class="content"><a class="title" href="/blog/2023/01/01/HTML/" title="HTML笔记">HTML笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/01/01/JavaScript/" title="JavaScript笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2023/01/01/JavaScript/JavaScript.png" onerror='this.onerror=null,this.src="/blog/img/404.png"' alt="JavaScript笔记"></a><div class="content"><a class="title" href="/blog/2023/01/01/JavaScript/" title="JavaScript笔记">JavaScript笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/01/01/JavaWeb/" title="JavaWeb笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2023/01/01/JavaWeb/JavaWeb.png" onerror='this.onerror=null,this.src="/blog/img/404.png"' alt="JavaWeb笔记"></a><div class="content"><a class="title" href="/blog/2023/01/01/JavaWeb/" title="JavaWeb笔记">JavaWeb笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/01/01/Linux/" title="Linux笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/2023/01/01/Linux/Linux.png" onerror='this.onerror=null,this.src="/blog/img/404.png"' alt="Linux笔记"></a><div class="content"><a class="title" href="/blog/2023/01/01/Linux/" title="Linux笔记">Linux笔记</a><time datetime="2022-12-31T16:00:00.000Z" title="发表于 2023-01-01 00:00:00">2023-01-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By wen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '701b8bc001a40a760558',
      clientSecret: 'a51b436adc471c3949a8f41be05c2d58cccab10a',
      repo: 'Hexo-Butterfly-Comment',
      owner: 'wen53231323',
      admin: ['wen53231323'],
      id: '1ff3d081f28d24940c08320b99a2b57c',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'VI32wmbmMoxvlhpTpoDBNeOk-MdYXbMMI',
      appKey: 'oFstfBFkCQIkjuk4ibCpbGqz',
      avatar: 'monsterid',
      serverURLs: 'https://vi32wmbm.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Gitalk' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/blog/js/search/local-search.js"></script></div></div></body></html>